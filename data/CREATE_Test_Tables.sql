<<<<<<< HEAD
set serveroutput on size unlimited

DROP   TABLE ProjPoint2D  PURGE;
CREATE TABLE ProjPoint2D ( id integer, label varchar2(20), angleDegrees number, geom mdsys.sdo_geometry );
SET FEEDBACK OFF
    INSERT INTO ProjPoint2D (id, label, angleDegrees, geom)
      SELECT rownum,
             CHR(dbms_random.value(65,90)) || to_char(round(dbms_random.value(0,1000),0),'FM9999') as label,
             ROUND(dbms_random.value(0,359.9),1) as angleDegrees,
             mdsys.sdo_geometry(2001,NULL,
                   MDSYS.SDO_POINT_TYPE(
                         ROUND(dbms_random.value(358880  - ( 10000 / 2 ),  
                                                 358880  + ( 10000 / 2 )),2),
                         ROUND(dbms_random.value(5407473 - (  5000 / 2 ), 
                                                 5407473 + (  5000 / 2 )),2),
                         NULL),
                   NULL,NULL)
       FROM DUAL
     CONNECT BY LEVEL <= 500; 
COMMIT;
SET FEEDBACK ON
SET HEADING OFF
SELECT 'Inserted '||count(*)||' records into ProjPoint2D' FROM ProjPoint2D;
SET HEADING ON
DELETE FROM USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'PROJPOINT2D'; 
COMMIT;
DECLARE
  v_shape mdsys.sdo_geometry;
BEGIN
  SELECT SDO_AGGR_MBR(geom) INTO v_shape FROM ProjPoint2D;
  INSERT INTO USER_SDO_GEOM_METADATA(TABLE_NAME,COLUMN_NAME,DIMINFO,SRID)
    VALUES ('PROJPOINT2D','GEOM',MDSYS.SDO_DIM_ARRAY(
    MDSYS.SDO_DIM_ELEMENT('X',V_SHAPE.SDO_ORDINATES(1),V_SHAPE.SDO_ORDINATES(3),0.05),
    MDSYS.SDO_DIM_ELEMENT('Y',V_SHAPE.SDO_ORDINATES(2),V_SHAPE.SDO_ORDINATES(4),0.05)),NULL);
END;
/
SHOW ERRORS
COMMIT;
CREATE INDEX ProjPoint2D_GEOM on ProjPoint2D(geom) 
       INDEXTYPE is mdsys.spatial_index 
       parameters('sdo_indx_dims=2, layer_gtype=point');

-- *******************************************************************************************************

DROP   TABLE ProjCircle2D  PURGE;
CREATE TABLE ProjCircle2D ( id integer, label varchar2(20), rgb varchar2(20), iRGB integer, geom mdsys.sdo_geometry );
SET FEEDBACK OFF
    INSERT INTO ProjCircle2D (id, label, rgb, iRGB, geom)
      SELECT rownum,
             CHR(dbms_random.value(65,90)) || to_char(round(dbms_random.value(0,1000),0),'FM9999') as label,
             ROUND(dbms_random.value(0,255),0) || ',' || ROUND(dbms_random.value(0,255),0) || ',' || ROUND(dbms_random.value(0,255),0) as rgb,
             power(2,16)* ROUND(dbms_random.value(0,255),0) + 
             power(2,8) * ROUND(dbms_random.value(0,255),0) + 
                          ROUND(dbms_random.value(0,255),0) as irgb,
		     mdsys.sdo_geometry(2003,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1003,4),
                                sdo_ordinate_array(x+2.0*radius,y,x+radius,y+radius,X,Y)) as geom 
       FROM (SELECT ROUND(dbms_random.value(358880  - ( 10000 / 2 ),  
                                            358880  + ( 10000 / 2 )),2) as x,
                    ROUND(dbms_random.value(5407473 - (  5000 / 2 ), 
                                            5407473 + (  5000 / 2 )),2) as y,
                    dbms_random.value(10,100) as radius
              FROM DUAL
           CONNECT BY LEVEL <= 500
        ) f; 
COMMIT;
SET FEEDBACK ON
SET HEADING OFF
SELECT 'Inserted '||count(*)||' records into ProjCircle2D' FROM ProjCircle2D;
SET HEADING ON
DELETE FROM USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'PROJCIRCLE2D'; 
COMMIT;
DECLARE
  v_shape mdsys.sdo_geometry;
BEGIN
  SELECT SDO_AGGR_MBR(geom) INTO v_shape FROM ProjCircle2D;
  INSERT INTO USER_SDO_GEOM_METADATA(TABLE_NAME,COLUMN_NAME,DIMINFO,SRID)
    VALUES ('PROJCIRCLE2D','GEOM',MDSYS.SDO_DIM_ARRAY(
    MDSYS.SDO_DIM_ELEMENT('X',V_SHAPE.SDO_ORDINATES(1),V_SHAPE.SDO_ORDINATES(2),0.05),
    MDSYS.SDO_DIM_ELEMENT('Y',V_SHAPE.SDO_ORDINATES(3),V_SHAPE.SDO_ORDINATES(4),0.05)),NULL);
END;
/
SHOW ERRORS
COMMIT;
CREATE INDEX ProjCircle2D_GEOM on ProjCircle2D(geom) 
       INDEXTYPE is mdsys.spatial_index 
       parameters('sdo_indx_dims=2, layer_gtype=polygon');

-- *******************************************************************************************************

DROP   TABLE ProjLine2D PURGE;
CREATE TABLE ProjLine2D ( linetype varchar2(40), geom mdsys.sdo_geometry );
INSERT INTO  ProjLine2D 
VALUES('VERTEXARC',
MDSYS.SDO_GEOMETRY(2002,NULL,NULL,
mdsys.sdo_elem_info_array(1,4,2,1,2,1,3,2,2),
MDSYS.SDO_ORDINATE_ARRAY(252000,5526000,252700,5526700,252500,5526700,252500,5526500)));
INSERT INTO ProjLine2D 
VALUES('VERTEX',
MDSYS.SDO_GEOMETRY(2002, NULL, NULL, 
      MDSYS.SDO_ELEM_INFO_ARRAY(1, 2, 1), 
      MDSYS.SDO_ORDINATE_ARRAY( 380326.792, 5167089.286, 380326.792, 5167889.286, 380826.792, 5167889.286, 380126.792, 5167489.286)));
INSERT INTO ProjLine2D 
VALUES('STRAIGHTVERTEX',
      MDSYS.SDO_GEOMETRY(2002, NULL, NULL, 
      MDSYS.SDO_ELEM_INFO_ARRAY(1, 2, 1), 
      MDSYS.SDO_ORDINATE_ARRAY( 380000.0, 5100000.0, 380000.0, 5160000.0)));
INSERT INTO ProjLine2D 
VALUES('45DEGREEVERTEX',
      MDSYS.SDO_GEOMETRY(2002, NULL, NULL, 
      MDSYS.SDO_ELEM_INFO_ARRAY(1, 2, 1), 
      MDSYS.SDO_ORDINATE_ARRAY( 380000.0, 5100000.0, 390000.0, 5110000.0)));
INSERT INTO ProjLine2D(LINETYPE,GEOM)
VALUES('DUPLICATEVERTEX',
      MDSYS.SDO_GEOMETRY(2002,null,null,
      MDSYS.SDO_ELEM_INFO_ARRAY(1,2,1),
      MDSYS.SDO_ORDINATE_ARRAY( 380000,5100000, 380000.001,5100000, 390000,5110000)));
COMMIT;
DELETE FROM USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'PROJLINE2D';
COMMIT;
DECLARE
  v_shape mdsys.sdo_geometry;
BEGIN
  SELECT SDO_AGGR_MBR(geom) INTO v_shape FROM ProjLine2D;
  INSERT INTO USER_SDO_GEOM_METADATA(TABLE_NAME,COLUMN_NAME,DIMINFO,SRID)
    VALUES ('PROJLINE2D','GEOM',MDSYS.SDO_DIM_ARRAY(
    MDSYS.SDO_DIM_ELEMENT('X',V_SHAPE.SDO_ORDINATES(1),V_SHAPE.SDO_ORDINATES(2),0.05),
    MDSYS.SDO_DIM_ELEMENT('Y',V_SHAPE.SDO_ORDINATES(3),V_SHAPE.SDO_ORDINATES(4),0.05)),NULL);
END;
/
SHOW ERRORS
COMMIT;
CREATE INDEX ProjLine2D_Geom on ProjLine2D(geom) 
       INDEXTYPE is mdsys.spatial_index 
       parameters('sdo_indx_dims=2, layer_gtype=line');

-- *******************************************************************************************************

DROP   TABLE ProjMultiLine2D  PURGE;
CREATE TABLE ProjMultiLine2D ( id integer, label varchar2(20), angleDegrees number, geom mdsys.sdo_geometry );
SET FEEDBACK OFF
    INSERT INTO ProjMultiLine2D (id, label, angleDegrees, geom)
      SELECT rownum,
             CHR(dbms_random.value(65,90)) || to_char(round(dbms_random.value(0,1000),0),'FM9999') as label,
             ROUND(dbms_random.value(0,359.9),1) as angleDegrees,
             mdsys.sdo_geometry(2006,NULL,NULL,MDSYS.SDO_ELEM_INFO_ARRAY(1,2,1,5,2,1),
                   MDSYS.SDO_ORDINATE_ARRAY(
                         ROUND(dbms_random.value(358880  - ( 10000 / 2 ),  358880  + ( 10000 / 2 )),2),
                         ROUND(dbms_random.value(5407473 - (  5000 / 2 ), 5407473 + (  5000 / 2 )),2),
                         ROUND(dbms_random.value(358880  - ( 10000 / 2 ),  358880  + ( 10000 / 2 )),2),
                         ROUND(dbms_random.value(5407473 - (  5000 / 2 ), 5407473 + (  5000 / 2 )),2),
                         ROUND(dbms_random.value(358880  - ( 10000 / 2 ),  358880  + ( 10000 / 2 )),2),
                         ROUND(dbms_random.value(5407473 - (  5000 / 2 ), 5407473 + (  5000 / 2 )),2),
                         ROUND(dbms_random.value(358880  - ( 10000 / 2 ),  358880  + ( 10000 / 2 )),2),
                         ROUND(dbms_random.value(5407473 - (  5000 / 2 ), 5407473 + (  5000 / 2 )),2))
                   )
       FROM DUAL
     CONNECT BY LEVEL <= 500; 
COMMIT;
SET FEEDBACK ON
SET HEADING OFF
SELECT 'Inserted '||count(*)||' records into ProjMultiLine2D' FROM ProjMultiLine2D;
SET HEADING ON
DELETE FROM USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'PROJMULTILINE2D'; 
COMMIT;
DECLARE
  v_shape mdsys.sdo_geometry;
BEGIN
  SELECT SDO_AGGR_MBR(geom) INTO v_shape FROM ProjMultiLine2D;
  INSERT INTO USER_SDO_GEOM_METADATA(TABLE_NAME,COLUMN_NAME,DIMINFO,SRID)
    VALUES ('PROJMULTILINE2D','GEOM',MDSYS.SDO_DIM_ARRAY(
    MDSYS.SDO_DIM_ELEMENT('X',V_SHAPE.SDO_ORDINATES(1),V_SHAPE.SDO_ORDINATES(2),0.05),
    MDSYS.SDO_DIM_ELEMENT('Y',V_SHAPE.SDO_ORDINATES(3),V_SHAPE.SDO_ORDINATES(4),0.05)),NULL);
END;
/
SHOW ERRORS
COMMIT;
CREATE INDEX ProjMultiLine2D_GEOM on ProjMultiLine2D(geom) 
       INDEXTYPE is mdsys.spatial_index 
       parameters('sdo_indx_dims=2, layer_gtype=multiline');

-- *******************************************************************************************************

DROP   TABLE ProjPoly2D PURGE;
CREATE TABLE ProjPoly2D ( polytype varchar2(40), geom mdsys.sdo_geometry );
INSERT INTO  ProjPoly2D (PolyType,Geom) 
VALUES( 'VERTEXWITHHOLE', MDSYS.SDO_GEOMETRY(2003, NULL, NULL, 
       MDSYS.SDO_ELEM_INFO_ARRAY(1, 1003, 1, 77, 2003, 1), 
       MDSYS.SDO_ORDINATE_ARRAY(
524570.7, 5202359.4, 524267.6, 5202035.7, 524720, 5201928.8, 524725.1, 5201939.5, 
524739.1, 5201953.4, 524752.6, 5201964.8, 524766, 5201976.2, 524783.1, 5201991.4,
524797.6, 5202011.7, 524804.6, 5202025, 524815, 5202040.8, 524815.6, 5202042.1,
524820.6, 5202052.9, 524825.9, 5202063.1, 524834.6, 5202085.3, 524843.6, 5202099.9,
524853.9, 5202114.5, 524864.6, 5202124.6, 524868.6, 5202130, 524876.1, 5202139.8,
524890.1, 5202158.2, 524903, 5202177.8, 524914.4, 5202194.3, 524925.9, 5202214.7,
524933.5, 5202228, 524945.6, 5202245.1, 524959, 5202260.3, 524968.6, 5202276.2,
524976.9, 5202289.5, 524984.5, 5202299.6, 524987.6, 5202304.1, 524995.4, 5202314.8, 
525005.5, 5202329.5, 525016.4, 5202343.4, 525022.6, 5202354.2, 525023.2, 5202355,
524976.5, 5202359.4, 524570.7, 5202359.4,
524548.319747, 5202136.448354,
524548.319747, 5202227.311646,
524738.654430, 5202227.311646,
524738.654430, 5202136.448354,
524548.319747, 5202136.448354
)));
INSERT INTO ProjPoly2D (PolyType,Geom) VALUES( 'VERTEXNOHOLE',
MDSYS.SDO_GEOMETRY(2003, NULL, NULL, 
MDSYS.SDO_ELEM_INFO_ARRAY(1, 1003, 1), 
MDSYS.SDO_ORDINATE_ARRAY(
361347.064, 5407661.54, 361310.469, 5407666.59, 361292.253, 5407663.80, 361249.719, 5407657.28, 
361171.344, 5407642.41, 361047.094, 5407631.34, 360960.656, 5407631.50, 360853.937, 5407628.56, 
360757.281, 5407630.97, 360693.594, 5407634.31, 360617.250, 5407637.28, 360540.969, 5407637.72, 
360457.125, 5407635.41, 360398.562, 5407638.88, 360371.128, 5407638.58, 360273.506, 5407637.55, 
360248.594, 5407637.28, 360167.312, 5407635.06, 360113.937, 5407633.59, 360017.719, 5407620.75, 
359893.687, 5407602.06, 359775.031, 5407573.31, 359631.344, 5407531.19, 359478.756, 5407504.41, 
359459.344, 5407501.00, 359449.272, 5407500.04, 359448.678, 5407499.98, 359309.750, 5407486.69, 
359183.125, 5407470.47, 359074.031, 5407462.34, 358959.719, 5407459.19, 358868.094, 5407461.75, 
358776.474, 5407468.17, 358763.656, 5407469.06, 358669.807, 5407482.06, 358641.125, 5407486.03, 
358523.219, 5407518.41, 358436.094, 5407541.47, 358400.812, 5407553.12, 358343.656, 5407572, 
358243.469, 5407607.41, 358150.969, 5407640.47, 358061.000, 5407673.63, 357966.281, 5407696.47, 
357853.750, 5407718.81, 357787.094, 5407737.31, 357705.375, 5407750.34, 357595.594, 5407765.13, 
357541.875, 5407776.38, 357490.687, 5407787.69, 357423.906, 5407811.28, 357352.031, 5407834.75, 
357336.562, 5407841.97, 357280.219, 5407855.66, 357257.219, 5407860.13, 357203.562, 5407868.81, 
357160.219, 5407872.72, 357075.719, 5407893.28, 357019.594, 5407899.38, 356973.812, 5407900.66,
356920.687, 5407891.56, 356893.250, 5407872.97, 356858.594, 5407841.50, 356836.844, 5407802.72,
356817.719, 5407761.47, 356786.250, 5407707.16, 356748.969, 5407678.13, 356718.875, 5407664.56, 
356693.469, 5407663.88, 356670.594, 5407663.25, 356642.812, 5407657.38, 356623.000, 5407639.03,
356589.156, 5407579.56, 356562.250, 5407543.19, 356562.312, 5407540.63, 356601.031, 5407521.34,
356606.469, 5407508.78, 356632.719, 5407481.50, 356638.156, 5407468.94, 356648.531, 5407461.56,
356679.625, 5407442.06, 356718.187, 5407427.88, 356728.344, 5407428.16, 356758.687, 5407434.06,
356776.375, 5407437.09, 356791.562, 5407440.06, 356814.125, 5407450.88, 356823.969, 5407461.31, 
356866.062, 5407500.66, 356868.531, 5407503.28, 356913.562, 5407527.44, 356946.062, 5407546.13,
357031.344, 5407586.66, 357074.062, 5407603.13, 357124.562, 5407614.69, 357162.531, 5407620.81,
357197.937, 5407626.91, 357274.312, 5407623.91, 357356.062, 5407610.91, 357427.344, 5407607.78,
357513.844, 5407605.06, 357567.562, 5407593.84, 357659.781, 5407570.94, 357746.969, 5407545.34,
357821.469, 5407519.41, 357916.937, 5407471.13, 357947.569, 5407456.85, 358009.750, 5407427.88, 
358105.000, 5407387.25, 358205.656, 5407336.59, 358277.906, 5407300.41, 358424.719, 5407235.75,
358546.548, 5407182.59, 358550.906, 5407180.69, 358653.594, 5407147.91, 358695.565, 5407138.62,
358786.656, 5407118.47, 358890.875, 5407118.81, 358974.562, 5407126.22, 359032.687, 5407138,
359136.469, 5407153.59, 359245.344, 5407169.31, 359301.750, 5407153.06, 359335.531, 5407128.53,
359385.500, 5407071.38, 359476.812, 5406992.47, 359565.281, 5406923.66, 359616.750, 5406902.16, 
359693.187, 5406896.66, 359810.062, 5406899.88, 359872.914, 5406915.92, 359888.281, 5406919.84,
360011.625, 5406961.44, 360086.812, 5406999.13, 360171.844, 5407047.28, 360241.687, 5407092.47,
360308.875, 5407142.69, 360368.781, 5407179.97, 360439.094, 5407209.91, 360519.719, 5407235.03,
360590.781, 5407239.53, 360679.844, 5407236.91, 360761.812, 5407216.28, 360849.000, 5407190.69,
360948.906, 5407165.44, 361020.469, 5407152.16, 361101.781, 5407154.41, 361211.094, 5407154.88, 
361294.844, 5407159.72, 361373.594, 5407161.91, 361421.500, 5407175.94, 361471.687, 5407197.69,
361491.437, 5407218.59, 361540.156, 5407291.19, 361546.812, 5407324.47, 361540.720, 5407383.04,
361540.047, 5407389.51, 361539.687, 5407392.97, 361530.969, 5407430.91, 361514.375, 5407476.28,
361489.875, 5407531.59, 361470.750, 5407576.88, 361444.281, 5407611.75, 361402.812, 5407638.63,
361356.437, 5407660.25, 361347.064, 5407661.54)));
INSERT INTO ProjPoly2D
VALUES( 'VERTEXNOHOLE',
MDSYS.SDO_GEOMETRY(2003, NULL, NULL, 
MDSYS.SDO_ELEM_INFO_ARRAY(1, 1003, 1),
MDSYS.SDO_ORDINATE_ARRAY(
476400.000, 237700.000, 475879.950, 237700.000, 475939.060, 237634.800, 476002.840, 237573.450,
476045.530, 237559.550, 476087.000, 237545.060, 476135.250, 237525.530, 476155.500, 237517.380,
476170.250, 237509.000, 476182.690, 237494.470, 476226.190, 237551.520, 476342.910, 237515.520,
476400.000, 237494.926, 476400.000, 237700.000)));
Prompt Simple outer shell made up of 3 vertex-to-vertex line finishing with circular arc
INSERT INTO ProjPoly2D
VALUES( 'COMPOUNDOUTERSHELL',
MDSYS.SDO_GEOMETRY(2003,NULL,NULL,
    MDSYS.SDO_ELEM_INFO_ARRAY(1,1005,2,1,2,1,5,2,2),
    MDSYS.SDO_ORDINATE_ARRAY(
    253014,5527010, 253010,5527001, 253006,5527011, 253010,5527011, 253014,5527010)));
INSERT INTO ProjPoly2D (PolyType,Geom) VALUES( 'VERTEXNOHOLE',
MDSYS.SDO_GEOMETRY(2003, NULL, NULL, 
MDSYS.SDO_ELEM_INFO_ARRAY(1, 1003, 1), 
MDSYS.SDO_ORDINATE_ARRAY(
524570.7, 5202359.4, 524267.6, 5202035.7, 524720.0, 5201928.8, 524725.1, 5201939.5, 
524739.1, 5201953.4, 524752.6, 5201964.8, 524766.0, 5201976.2, 524783.1, 5201991.4,
524797.6, 5202011.7, 524804.6, 5202025.0, 524815.0, 5202040.8, 524815.6, 5202042.1,
524820.6, 5202052.9, 524825.9, 5202063.1, 524834.6, 5202085.3, 524843.6, 5202099.9,
524853.9, 5202114.5, 524864.6, 5202124.6, 524868.6, 5202130.0, 524876.1, 5202139.8,
524890.1, 5202158.2, 524903.0, 5202177.8, 524914.4, 5202194.3, 524925.9, 5202214.7,
524933.5, 5202228.0, 524945.6, 5202245.1, 524959.0, 5202260.3, 524968.6, 5202276.2,
524976.9, 5202289.5, 524984.5, 5202299.6, 524987.6, 5202304.1, 524995.4, 5202314.8, 
525005.5, 5202329.5, 525016.4, 5202343.4, 525022.6, 5202354.2, 525023.2, 5202355.0,
524976.5, 5202359.4, 524570.7, 5202359.4)));
INSERT INTO ProjPoly2D (PolyType,Geom) 
VALUES( 'VERTEXWITHARCNOHOLE',
    MDSYS.SDO_GEOMETRY(2003,NULL,NULL,
    MDSYS.SDO_ELEM_INFO_ARRAY(1,1005,2,1,2,1,5,2,2),
    MDSYS.SDO_ORDINATE_ARRAY(
    253014,5527010, 253010,5527001, 253006,5527011, 253010,5527011, 253014,5527010))
);
INSERT INTO ProjPoly2D (PolyType,Geom) 
VALUES( 'NORMALISEDRECTANGLENOHOLE',
MDSYS.SDO_GEOMETRY(2003, NULL, NULL, 
MDSYS.SDO_ELEM_INFO_ARRAY(1, 1003, 3), 
MDSYS.SDO_ORDINATE_ARRAY(190000,5120000,640000,5630000)));
INSERT INTO ProjPoly2D (PolyType,Geom) 
VALUES( 'CURVEPOLYWITHHOLE',
MDSYS.SDO_GEOMETRY(2003,NULL,NULL,
MDSYS.SDO_ELEM_INFO_ARRAY(1,1003,4,7,2003,4),
MDSYS.SDO_ORDINATE_ARRAY(253000,5527000,252000,5527000,252000,5526000,252700,5526700,252500,5526700,252500,5526500)));

DELETE FROM USER_SDO_GEOM_METADATA WHERE Table_name = 'PROJPOLY2D'; 
COMMIT;
DECLARE
  v_shape mdsys.sdo_geometry;
BEGIN
  SELECT SDO_AGGR_MBR(geom) INTO v_shape FROM ProjPoly2D;
  INSERT INTO USER_SDO_GEOM_METADATA(TABLE_NAME,COLUMN_NAME,DIMINFO,SRID)
    VALUES ('PROJPOLY2D','GEOM',MDSYS.SDO_DIM_ARRAY(
    MDSYS.SDO_DIM_ELEMENT('X',V_SHAPE.SDO_ORDINATES(1),V_SHAPE.SDO_ORDINATES(2),0.05),
    MDSYS.SDO_DIM_ELEMENT('Y',V_SHAPE.SDO_ORDINATES(3),V_SHAPE.SDO_ORDINATES(4),0.05)),NULL);
END;
/
SHOW ERRORS
COMMIT;
CREATE INDEX ProjPoly2D_Geom on ProjPoly2D(geom) 
       INDEXTYPE is mdsys.spatial_index 
       parameters('sdo_indx_dims=2, layer_gtype=polygon');

-- **********************************************************************************

DROP   TABLE ProjMultiPoly2D  PURGE;
CREATE TABLE ProjMultiPoly2D ( id integer, label varchar2(20), angleDegrees number, geom mdsys.sdo_geometry );
SET FEEDBACK OFF
    INSERT INTO ProjMultiPoly2D (id, label, angleDegrees, geom)
      SELECT rownum,
             CHR(dbms_random.value(65,90)) || to_char(round(dbms_random.value(0,1000),0),'FM9999') as label,
             ROUND(dbms_random.value(0,359.9),1) as angleDegrees,
             mdsys.sdo_geometry(2007,NULL,NULL,MDSYS.SDO_ELEM_INFO_ARRAY(1,1003,3,5,1003,3),
                   MDSYS.SDO_ORDINATE_ARRAY(
                         ROUND(dbms_random.value(358880  - ( 10000 / 2 ),  358880  + ( 10000 / 2 )),2),
                         ROUND(dbms_random.value(5407473 - (  5000 / 2 ), 5407473 + (  5000 / 2 )),2),
                         ROUND(dbms_random.value(358880  - ( 10000 / 2 ),  358880  + ( 10000 / 2 )),2),
                         ROUND(dbms_random.value(5407473 - (  5000 / 2 ), 5407473 + (  5000 / 2 )),2),
                         ROUND(dbms_random.value(358880  - ( 10000 / 2 ),  358880  + ( 10000 / 2 )),2),
                         ROUND(dbms_random.value(5407473 - (  5000 / 2 ), 5407473 + (  5000 / 2 )),2),
                         ROUND(dbms_random.value(358880  - ( 10000 / 2 ),  358880  + ( 10000 / 2 )),2),
                         ROUND(dbms_random.value(5407473 - (  5000 / 2 ), 5407473 + (  5000 / 2 )),2))
                   )
       FROM DUAL
     CONNECT BY LEVEL <= 500; 
COMMIT;
SET FEEDBACK ON
SET HEADING OFF
SELECT 'Inserted '||count(*)||' records into ProjMultiPoly2D' FROM ProjMultiPoly2D;
SET HEADING ON
DELETE FROM USER_SDO_GEOM_METADATA WHERE TABLE_NAME = upper('ProjMultiPoly2D'); 
COMMIT;
DECLARE
  v_shape mdsys.sdo_geometry;
BEGIN
  SELECT SDO_AGGR_MBR(geom) INTO v_shape FROM ProjMultiPoly2D;
  INSERT INTO USER_SDO_GEOM_METADATA(TABLE_NAME,COLUMN_NAME,DIMINFO,SRID)
    VALUES (upper('ProjMultiPoly2D'),'GEOM',MDSYS.SDO_DIM_ARRAY(
    MDSYS.SDO_DIM_ELEMENT('X',V_SHAPE.SDO_ORDINATES(1),V_SHAPE.SDO_ORDINATES(3),0.05),
    MDSYS.SDO_DIM_ELEMENT('Y',V_SHAPE.SDO_ORDINATES(2),V_SHAPE.SDO_ORDINATES(4),0.05)),NULL);
END;
/
SHOW ERRORS
COMMIT;
CREATE INDEX ProjMultiPoly2D_GEOM on ProjMultiPoly2D(geom) 
       INDEXTYPE is mdsys.spatial_index 
       parameters('sdo_indx_dims=2, layer_gtype=multipolygon');

-- *********************************************************************************

DROP   TABLE ProjCompound2D PURGE;
CREATE TABLE ProjCompound2D ( geom  mdsys.sdo_geometry );
INSERT INTO  ProjCompound2D 
VALUES(
MDSYS.SDO_GEOMETRY(2004,NULL,NULL,
MDSYS.SDO_ELEM_INFO_ARRAY(1,1005,2,1,2,1,5,2,2),
MDSYS.SDO_ORDINATE_ARRAY(253006,5527010,253010,5527001,253014,5527010,253010,5527014,253006,5527010)) );
INSERT INTO ProjCompound2D 
VALUES(
MDSYS.SDO_GEOMETRY(2004, NULL, NULL, 
MDSYS.SDO_ELEM_INFO_ARRAY(1, 2, 1, 63, 2, 1, 113, 1003, 1, 189, 2003, 1), 
MDSYS.SDO_ORDINATE_ARRAY(
524769.7, 5202553.8,
524771.1, 5202553.2,
524781.4, 5202550,
524791, 5202547.4,
524802.4, 5202545.5,
524826.5, 5202541,
524834.1, 5202539.1,
524840.5, 5202536.5,
524852.5, 5202532.7,
524865.9, 5202527.6,
524870.1, 5202525.7,
524884.9, 5202517.5,
524900.1, 5202507.3,
524914.1, 5202498.3,
524924.9, 5202492.6,
524933.6, 5202488.8,
524944.5, 5202488.2,
524952.6, 5202486.9,
524966.6, 5202485,
524980.1, 5202483.7,
524992.6, 5202478.6, 
525005.5, 5202473.5, 
525015.6, 5202469, 
525028.1, 5202462.6, 
525048.3, 5202450.6, 
525056, 5202443, 
525057.9, 5202424, 
525053.4, 5202410, 
525043.6, 5202384.6, 
525036.1, 5202373.8, 
525023.2, 5202355,
524619.9, 5201690.4,
524621.6, 5201693.8,
524625.6, 5201698.3,
524632.6, 5201707.8,
524645.4, 5201726.8,
524649.1, 5201731.9,
524651.1, 5201735,
524653.6, 5201738.9,
524658.6, 5201745.8,
524664.5, 5201753.5,
524670.9, 5201767.4,
524674.6, 5201773.8,
524679.6, 5201788.4,
524679.6, 5201789,
524681.1, 5201797.3,
524683.6, 5201808,
524686.9, 5201818.8,
524695.6, 5201839.8,
524700.1, 5201851.2,
524704.6, 5201865.2,
524708, 5201882.3,
524711.6, 5201896.3,
524714.4, 5201909,
524717.6, 5201923.6,
524720, 5201928.8,
524570.7, 5202359.4,
524267.6, 5202035.7,
524720, 5201928.8,
524725.1, 5201939.5, 
524739.1, 5201953.4,
524752.6, 5201964.8,
524766, 5201976.2,
524783.1, 5201991.4,
524797.6, 5202011.7, 
524804.6, 5202025,
524815, 5202040.8,
524815.6, 5202042.1,
524820.6, 5202052.9,
524825.9, 5202063.1,
524834.6, 5202085.3,
524843.6, 5202099.9,
524853.9, 5202114.5,
524864.6, 5202124.6,
524868.6, 5202130,
524876.1, 5202139.8,
524890.1, 5202158.2, 
524903, 5202177.8,
524914.4, 5202194.3,
524925.9, 5202214.7,
524933.5, 5202228,
524945.6, 5202245.1,
524959, 5202260.3,
524968.6, 5202276.2,
524976.9, 5202289.5,
524984.5, 5202299.6,
524987.6, 5202304.1,
524995.4, 5202314.8, 
525005.5, 5202329.5, 
525016.4, 5202343.4, 
525022.6, 5202354.2, 
525023.2, 5202355,
524976.5, 5202359.4,
524570.7, 5202359.4,
524548.319747, 5202136.448354,
524548.319747, 5202227.311646,
524738.654430, 5202227.311646,
524738.654430, 5202136.448354,
524548.319747, 5202136.448354
)));
INSERT INTO PROJCOMPOUND2D 
VALUES(
MDSYS.SDO_GEOMETRY(2004, NULL, NULL,
MDSYS.SDO_ELEM_INFO_ARRAY(1, 1, 1, 3, 2, 1, 65, 2, 1, 115, 1003, 1, 191, 2003, 1),
MDSYS.SDO_ORDINATE_ARRAY(
524760.0, 5202550.0,
524769.7, 5202553.8,
524771.1, 5202553.2,
524781.4, 5202550,
524791, 5202547.4,
524802.4, 5202545.5,
524826.5, 5202541,
524834.1, 5202539.1,
524840.5, 5202536.5,
524852.5, 5202532.7,
524865.9, 5202527.6,
524870.1, 5202525.7,
524884.9, 5202517.5,
524900.1, 5202507.3,
524914.1, 5202498.3,
524924.9, 5202492.6,
524933.6, 5202488.8,
524944.5, 5202488.2,
524952.6, 5202486.9,
524966.6, 5202485,
524980.1, 5202483.7,
524992.6, 5202478.6,
525005.5, 5202473.5,
525015.6, 5202469,
525028.1, 5202462.6,
525048.3, 5202450.6,
525056, 5202443,
525057.9, 5202424,
525053.4, 5202410,
525043.6, 5202384.6,
525036.1, 5202373.8,
525023.2, 5202355,
524619.9, 5201690.4,
524621.6, 5201693.8,
524625.6, 5201698.3,
524632.6, 5201707.8,
524645.4, 5201726.8,
524649.1, 5201731.9,
524651.1, 5201735,
524653.6, 5201738.9,
524658.6, 5201745.8,
524664.5, 5201753.5,
524670.9, 5201767.4,
524674.6, 5201773.8,
524679.6, 5201788.4,
524679.6, 5201789,
524681.1, 5201797.3,
524683.6, 5201808,
524686.9, 5201818.8,
524695.6, 5201839.8,
524700.1, 5201851.2,
524704.6, 5201865.2,
524708, 5201882.3,
524711.6, 5201896.3,
524714.4, 5201909,
524717.6, 5201923.6,
524720, 5201928.8,
524570.7, 5202359.4,
524267.6, 5202035.7,
524720, 5201928.8,
524725.1, 5201939.5,
524739.1, 5201953.4,
524752.6, 5201964.8,
524766, 5201976.2,
524783.1, 5201991.4,
524797.6, 5202011.7,
524804.6, 5202025,
524815, 5202040.8,
524815.6, 5202042.1,
524820.6, 5202052.9,
524825.9, 5202063.1,
524834.6, 5202085.3,
524843.6, 5202099.9,
524853.9, 5202114.5,
524864.6, 5202124.6,
524868.6, 5202130,
524876.1, 5202139.8,
524890.1, 5202158.2,
524903, 5202177.8,
524914.4, 5202194.3,
524925.9, 5202214.7,
524933.5, 5202228,
524945.6, 5202245.1,
524959, 5202260.3,
524968.6, 5202276.2,
524976.9, 5202289.5,
524984.5, 5202299.6,
524987.6, 5202304.1,
524995.4, 5202314.8,
525005.5, 5202329.5,
525016.4, 5202343.4,
525022.6, 5202354.2,
525023.2, 5202355,
524976.5, 5202359.4,
524570.7, 5202359.4,
524548.319747, 5202136.448354,
524548.319747, 5202227.311646,
524738.654430, 5202227.311646,
524738.654430, 5202136.448354,
524548.319747, 5202136.448354
)));
COMMIT;
DELETE FROM USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'PROJCOMPOUND2D'; 
COMMIT;
DECLARE
  v_shape mdsys.sdo_geometry;
BEGIN
  SELECT SDO_AGGR_MBR(geom) INTO v_shape FROM PROJCOMPOUND2D;
  INSERT INTO USER_SDO_GEOM_METADATA(TABLE_NAME,COLUMN_NAME,DIMINFO,SRID)
    VALUES ('PROJCOMPOUND2D',
            'GEOM',
            MDSYS.SDO_DIM_ARRAY(
                MDSYS.SDO_DIM_ELEMENT('X',V_SHAPE.SDO_ORDINATES(1),V_SHAPE.SDO_ORDINATES(3),0.05),
                MDSYS.SDO_DIM_ELEMENT('Y',V_SHAPE.SDO_ORDINATES(2),V_SHAPE.SDO_ORDINATES(4),0.05)),
            NULL);
END;
/
SHOW ERRORS
SELECT diminfo from USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'PROJCOMPOUND2D'; 
DROP INDEX PROJCOMPOUND2D_Geom;
CREATE INDEX PROJCOMPOUND2D_Geom on PROJCOMPOUND2D(geom) 
       indextype is mdsys.spatial_index 
       parameters('sdo_indx_dims=2, layer_gtype=collection');

-- ***********************************************************************************

DROP   TABLE PROJMULTIPOINT2D PURGE;
CREATE TABLE ProjMultiPoint2D ( gid integer, text varchar2(10), geom mdsys.sdo_geometry );
insert into projmultipoint2d (gid,text,geom)
select rownum as gid,
       'Group ' || gid as text,
       geom
  from (select trunc(dbms_random.value(1,10)) as gid, sdo_aggr_union(sdoaggrtype(geom,0.05)) as geom
          from projpoint2d p
        group by trunc(dbms_random.value(1,10))
       );
commit;
DELETE FROM USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'PROJMULTIPOINT2D'; 
COMMIT;
DECLARE
  v_shape mdsys.sdo_geometry;
BEGIN
  SELECT SDO_AGGR_MBR(geom) INTO v_shape FROM PROJMULTIPOINT2D;
  INSERT INTO USER_SDO_GEOM_METADATA(TABLE_NAME,COLUMN_NAME,DIMINFO,SRID)
    VALUES ('PROJMULTIPOINT2D',
            'GEOM',
            MDSYS.SDO_DIM_ARRAY(
                MDSYS.SDO_DIM_ELEMENT('X',V_SHAPE.SDO_ORDINATES(1),V_SHAPE.SDO_ORDINATES(3),0.05),
                MDSYS.SDO_DIM_ELEMENT('Y',V_SHAPE.SDO_ORDINATES(2),V_SHAPE.SDO_ORDINATES(4),0.05)),
            NULL);
END;
/
SHOW ERRORS
SELECT diminfo from USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'PROJMULTIPOINT2D'; 
DROP INDEX PROJMULTIPOINT2D_Geom;
CREATE INDEX PROJMULTIPOINT2D_Geom on PROJMULTIPOINT2D(geom) 
       indextype is mdsys.spatial_index 
       parameters('sdo_indx_dims=2, layer_gtype=multipoint');

-- *****************************************************************************

DROP TABLE Proj41014Poly2D;
CREATE TABLE Proj41014Poly2D ( PolyType Varchar2(40), geom mdsys.sdo_geometry );
INSERT INTO Proj41014Poly2D
VALUES ( 'MANYDIGITS',
MDSYS.SDO_GEOMETRY(2003, 41014, NULL,
MDSYS.SDO_ELEM_INFO_ARRAY(1, 1003, 1),
MDSYS.SDO_ORDINATE_ARRAY(
703004.4000000001, 1829970.0999999999,
703014.8000000000, 1829973.6000000001,
703018.3000000000, 1829983.8999999999,
703019.1000000001, 1830008.2000000000,
703013.9000000001, 1830033.2000000000,
703001.8000000000, 1830043.5999999999,
702994.9000000001, 1830037.4999999998,
702989.7000000001, 1830019.3999999999,
702990.5000000001, 1829991.7000000000,
702993.2000000001, 1829975.3000000000,
703004.4000000001, 1829970.0999999999)));
INSERT INTO PROJ41014POLY2D
VALUES ( 'ONEDIGIT',
MDSYS.SDO_GEOMETRY(2003, 41014, NULL, MDSYS.SDO_ELEM_INFO_ARRAY(1, 1003, 1),
MDSYS.SDO_ORDINATE_ARRAY(
703004.4, 1829970.1, 703014.8, 1829973.6, 703018.3, 1829983.9, 703019.1, 1830008.2, 
703013.9, 1830033.2, 703001.8, 1830043.6, 702994.9, 1830037.5, 702989.7, 1830019.4, 
702990.5, 1829991.7, 702993.2, 1829975.3, 703004.4, 1829970.1)));
INSERT INTO PROJ41014POLY2D
VALUES ( 'POLYGON',
         MDSYS.SDO_GEOMETRY(2003, 41014, NULL, MDSYS.SDO_ELEM_INFO_ARRAY(1, 1003, 1),
         MDSYS.SDO_ORDINATE_ARRAY(
         721336.1, 1835841.6, 721318.0, 1835849.6, 721307.8, 1835854.1, 
         721295.0, 1835856.4, 721286.0, 1835847.5, 721275.5, 1835828.2, 
         721246.3, 1835816.7, 721214.4, 1835810.2, 721201.3, 1835793.6, 
         721164.1, 1835759.7, 721093.2, 1835715.2, 721120.9, 1835681.6, 
         721144.2, 1835692.1, 721270.0, 1835764.9, 721312.8, 1835725.2, 
         721316.1, 1835720.6, 721323.3, 1835735.9, 721340.7, 1835748.0, 
         721381.9, 1835744.2, 721428.2, 1835732.8, 721448.9, 1835730.7, 
         721454.9, 1835737.5, 721457.8, 1835748.7, 721454.8, 1835761.6, 
         721443.2, 1835773.2, 721422.9, 1835783.2, 721404.2, 1835795.9, 
         721387.0, 1835813.8, 721354.4, 1835833.6, 721336.1, 1835841.6)));
COMMIT;
DELETE FROM USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'PROJ41014POLY2D'; 
COMMIT;
DECLARE
  v_shape mdsys.sdo_geometry;
BEGIN
  SELECT SDO_AGGR_MBR(geom) INTO v_shape FROM PROJ41014POLY2D;
  INSERT INTO USER_SDO_GEOM_METADATA(TABLE_NAME,COLUMN_NAME,DIMINFO,SRID)
    VALUES ('PROJ41014POLY2D',
            'GEOM',
            MDSYS.SDO_DIM_ARRAY(
                MDSYS.SDO_DIM_ELEMENT('X',V_SHAPE.SDO_ORDINATES(1),V_SHAPE.SDO_ORDINATES(3),0.05),
                MDSYS.SDO_DIM_ELEMENT('Y',V_SHAPE.SDO_ORDINATES(2),V_SHAPE.SDO_ORDINATES(4),0.05)),
            41014);
END;
/
SHOW ERRORS
SELECT diminfo from USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'PROJ41014POLY2D'; 
DROP INDEX PROJ41014POLY2D_Geom;
CREATE INDEX PROJ41014POLY2D_Geom on PROJ41014POLY2D(geom) 
       indextype is mdsys.spatial_index 
       parameters('sdo_indx_dims=2, layer_gtype=polygon');

-- *****************************************************************************

DROP   TABLE ProjPoint3D PURGE;
CREATE TABLE ProjPoint3D ( id integer, geom MDSYS.SDO_GEOMETRY );
COMMIT;
SET FEEDBACK OFF
    INSERT INTO ProjPoint3D
      SELECT rownum,
             mdsys.sdo_geometry(3001,NULL,
                   MDSYS.SDO_POINT_TYPE(
                         ROUND(dbms_random.value(358880  - ( 10000 / 2 ),  
                                                 358880  + ( 10000 / 2 )),2),
                         ROUND(dbms_random.value(5407473 - (  5000 / 2 ), 
                                                 5407473 + (  5000 / 2 )),2),
                         ROUND(dbms_random.value( -1000 - ( 10000 / 2 ), 
                                                   1000 + ( 10000 / 2 )),2)),
                   NULL,NULL)
       FROM DUAL
     CONNECT BY LEVEL <= 500; 
COMMIT;
SET FEEDBACK ON
SELECT COUNT(*) FROM ProjPoint3D;

SELECT 'Inserted '||count(*)||' records into ProjPoint3D' FROM ProjPoint3D;
SET HEADING ON
DELETE FROM USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'PROJPOINT3D'; 
COMMIT;
DECLARE
  v_shape mdsys.sdo_geometry;
BEGIN
  SELECT SDO_AGGR_MBR(geom) INTO v_shape FROM PROJPoint3D;
  INSERT INTO USER_SDO_GEOM_METADATA(TABLE_NAME,COLUMN_NAME,DIMINFO,SRID)
    VALUES ('PROJPOINT3D','GEOM',MDSYS.SDO_DIM_ARRAY(
    MDSYS.SDO_DIM_ELEMENT('X',V_SHAPE.SDO_ORDINATES(1),V_SHAPE.SDO_ORDINATES(2),0.005),
    MDSYS.SDO_DIM_ELEMENT('Y',V_SHAPE.SDO_ORDINATES(3),V_SHAPE.SDO_ORDINATES(4),0.005),
    MDSYS.SDO_DIM_ELEMENT('Z',V_SHAPE.SDO_ORDINATES(3),V_SHAPE.SDO_ORDINATES(4),0.005)),NULL);
END;
/
SHOW ERRORS
CREATE INDEX ProjPoint3D_Geom on ProjPoint3D(geom) 
       indextype is mdsys.spatial_index 
       parameters('sdo_indx_dims=2, layer_gtype=point');

-- ****************************************************************

DROP   TABLE PROJMULTIPOINT3D PURGE;
CREATE TABLE ProjMultiPoint3D ( geom MDSYS.SDO_GEOMETRY );
INSERT INTO  ProjMultiPoint3D 
VALUES ( MDSYS.SDO_GEOMETRY(3005,NULL,NULL,
               MDSYS.SDO_ELEM_INFO_ARRAY(1,1,4),
               MDSYS.SDO_ORDINATE_ARRAY(252000,5526500,1,253000,5526000,2,254000,5526000,3,254000,5527000,4)));
COMMIT;
DELETE FROM USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'PROJMULTIPOINT3D'; 
COMMIT;
DECLARE
  v_shape mdsys.sdo_geometry;
BEGIN
  SELECT SDO_AGGR_MBR(geom) INTO v_shape FROM PROJMULTIPOINT3D;
  INSERT INTO USER_SDO_GEOM_METADATA(TABLE_NAME,COLUMN_NAME,DIMINFO,SRID)
    VALUES ('PROJMULTIPOINT3D',
            'GEOM',
            MDSYS.SDO_DIM_ARRAY(
                MDSYS.SDO_DIM_ELEMENT('X',V_SHAPE.SDO_ORDINATES(1),V_SHAPE.SDO_ORDINATES(4),0.05),
                MDSYS.SDO_DIM_ELEMENT('Y',V_SHAPE.SDO_ORDINATES(2),V_SHAPE.SDO_ORDINATES(5),0.05),
                MDSYS.SDO_DIM_ELEMENT('Z',V_SHAPE.SDO_ORDINATES(3),V_SHAPE.SDO_ORDINATES(6),0.05)),
            NULL);
END;
/
SHOW ERRORS
SELECT diminfo from USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'PROJMULTIPOINT3D'; 
DROP INDEX PROJMULTIPOINT3D_Geom;
CREATE INDEX PROJMULTIPOINT3D_Geom on PROJMULTIPOINT3D(geom) 
       indextype is mdsys.spatial_index 
       parameters('sdo_indx_dims=2, layer_gtype=multipoint');

-- *****************************************************************************

DROP   TABLE ProjLine3D PURGE;
CREATE TABLE ProjLine3D ( LineType VarChar2(40), geom MDSYS.SDO_GEOMETRY );
INSERT INTO  ProjLine3D 
VALUES ( 'COMPOUND',
    MDSYS.SDO_GEOMETRY(3002,NULL,NULL,
      mdsys.sdo_elem_info_array(1,4,2,1,2,1,4,2,2),
      MDSYS.SDO_ORDINATE_ARRAY(252000,5526000,1,252700,5526700,2,252500,5526700,3,252500,5526500,4))
);
INSERT INTO PROJLINE3D 
VALUES('VERTEX',
MDSYS.SDO_GEOMETRY(3002, NULL, NULL, 
MDSYS.SDO_ELEM_INFO_ARRAY(1, 2, 1), 
MDSYS.SDO_ORDINATE_ARRAY(
380326.792, 5167089.286, 1,
380326.792, 5167889.286, 2,
380826.792, 5167889.286, 3,
380126.792, 5167489.286, 4)));
COMMIT;
DELETE FROM USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'PROJLINE3D'; 
COMMIT;
DECLARE
  v_shape mdsys.sdo_geometry;
BEGIN
  SELECT SDO_AGGR_MBR(geom) INTO v_shape FROM PROJLINE3D;
  INSERT INTO USER_SDO_GEOM_METADATA(TABLE_NAME,COLUMN_NAME,DIMINFO,SRID)
    VALUES ('PROJLINE3D',
            'GEOM',
            MDSYS.SDO_DIM_ARRAY(
                MDSYS.SDO_DIM_ELEMENT('X',V_SHAPE.SDO_ORDINATES(1),V_SHAPE.SDO_ORDINATES(4),0.05),
                MDSYS.SDO_DIM_ELEMENT('Y',V_SHAPE.SDO_ORDINATES(2),V_SHAPE.SDO_ORDINATES(5),0.05),
                MDSYS.SDO_DIM_ELEMENT('Z',V_SHAPE.SDO_ORDINATES(3),V_SHAPE.SDO_ORDINATES(6),0.05)),
            NULL);
END;
/
SHOW ERRORS
SELECT diminfo from USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'PROJLINE3D'; 
DROP INDEX PROJLINE3D_Geom;
CREATE INDEX PROJLINE3D_Geom on PROJLINE3D(geom) 
       indextype is mdsys.spatial_index 
       parameters('sdo_indx_dims=2, layer_gtype=line');

-- *****************************************************************************

DROP   TABLE ProjPoly3D PURGE;
CREATE TABLE ProjPoly3D ( PolyType VarChar2(40), geom MDSYS.SDO_GEOMETRY );
INSERT INTO  ProjPoly3D 
VALUES ( 'COMPOUND',
         MDSYS.SDO_GEOMETRY(3003,NULL,NULL,
               MDSYS.SDO_ELEM_INFO_ARRAY(1,1005,2,1,2,1,7,2,2),
               MDSYS.SDO_ORDINATE_ARRAY(253014,5527010,1,253010,5527001,2,253006,5527011,3,253010,5527011,4,253014,5527010,1)));
INSERT INTO PROJPOLY3D
VALUES( 'VERTEXNOHOLE',
MDSYS.SDO_GEOMETRY(3003, NULL, NULL, 
MDSYS.SDO_ELEM_INFO_ARRAY(1, 1003, 1),
MDSYS.SDO_ORDINATE_ARRAY(
476400, 237700, 1,
475879.950, 237700, 2,
475939.060, 237634.800, 3,
476002.840, 237573.450, 4,
476045.530, 237559.550, 5,
476087, 237545.060, 6,
476135.250, 237525.530, 7,
476155.500, 237517.380, 8,
476170.250, 237509, 9,
476182.690, 237494.470, 10,
476226.190, 237551.520, 11,
476342.910, 237515.520, 12,
476400, 237494.926, 13,
476400, 237700, 1)));
COMMIT;
DELETE FROM USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'PROJPOLY3D'; 
COMMIT;
DECLARE
  v_shape mdsys.sdo_geometry;
BEGIN
  SELECT SDO_AGGR_MBR(geom) INTO v_shape FROM PROJPOLY3D;
  INSERT INTO USER_SDO_GEOM_METADATA(TABLE_NAME,COLUMN_NAME,DIMINFO,SRID)
    VALUES ('PROJPOLY3D',
            'GEOM',
            MDSYS.SDO_DIM_ARRAY(
                MDSYS.SDO_DIM_ELEMENT('X',V_SHAPE.SDO_ORDINATES(1),V_SHAPE.SDO_ORDINATES(4),0.05),
                MDSYS.SDO_DIM_ELEMENT('Y',V_SHAPE.SDO_ORDINATES(2),V_SHAPE.SDO_ORDINATES(5),0.05),
                MDSYS.SDO_DIM_ELEMENT('Z',V_SHAPE.SDO_ORDINATES(3),V_SHAPE.SDO_ORDINATES(6),0.05)),
            NULL);
END;
/
SHOW ERRORS
select diminfo from USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'PROJPOLY3D'; 
DROP INDEX PROJPOLY3D_Geom;
CREATE INDEX PROJPOLY3D_Geom on PROJPOLY3D(geom) 
       indextype is mdsys.spatial_index 
       parameters('sdo_indx_dims=2, layer_gtype=polygon');

-- *******************************************************************************************************

DROP   TABLE GeodPoint2D PURGE;
CREATE TABLE GeodPoint2D ( id integer, geom mdsys.sdo_geometry );
SET FEEDBACK OFF
    INSERT INTO GeodPoint2D
      SELECT rownum,
             mdsys.sdo_geometry(2001,8311,
                   MDSYS.SDO_POINT_TYPE(
                         ROUND(dbms_random.value(112,147),2),
                         ROUND(dbms_random.value(-10,-44),2),
                         NULL),
                   NULL,NULL)
       FROM DUAL
     CONNECT BY LEVEL <= 500; 
COMMIT;
SET FEEDBACK ON
SET HEADING OFF
SELECT 'Inserted '||count(*)||' records into GeodPoint2D' FROM ProjPoint2D;
SET HEADING ON
DELETE FROM USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'GEODPOINT2D'; 
COMMIT;
DECLARE
  v_shape mdsys.sdo_geometry;
BEGIN
  SELECT SDO_AGGR_MBR(geom) INTO v_shape FROM GEODPOINT2D;
  INSERT INTO USER_SDO_GEOM_METADATA(TABLE_NAME,COLUMN_NAME,DIMINFO,SRID)
    VALUES ('GEODPOINT2D','GEOM',MDSYS.SDO_DIM_ARRAY(
    MDSYS.SDO_DIM_ELEMENT('Longitude',V_SHAPE.SDO_ORDINATES(1),V_SHAPE.SDO_ORDINATES(3),0.05),
    MDSYS.SDO_DIM_ELEMENT('Latitude' ,V_SHAPE.SDO_ORDINATES(2),V_SHAPE.SDO_ORDINATES(4),0.05)),8311);
END;
/
SHOW ERRORS
SELECT diminfo FROM USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'GEODPOINT2D'; 
DROP INDEX GeodPoint2D_Geom;
CREATE INDEX GeodPoint2D_Geom on GeodPoint2D(geom) 
       INDEXTYPE IS mdsys.spatial_index 
       PARAMETERS('sdo_indx_dims=2, layer_gtype=point');

-- *******************************************************************************************************

DROP   TABLE GeodPoint3D PURGE;
CREATE TABLE GeodPoint3D ( id integer, geom mdsys.sdo_geometry );
SET FEEDBACK OFF
    INSERT INTO GeodPoint3D
      SELECT rownum,
             mdsys.sdo_geometry(3001,8311,
                   MDSYS.SDO_POINT_TYPE(
                         ROUND(dbms_random.value(112,147),2),
                         ROUND(dbms_random.value(-10,-44),2),
                         ROUND(dbms_random.value(0,10000),2)),
                   NULL,NULL)
       FROM DUAL
     CONNECT BY LEVEL <= 500; 
COMMIT;
SET FEEDBACK ON
SET HEADING OFF
SELECT 'Inserted '||count(*)||' records into GeodPoint3D' FROM ProjPoint3D;
SET HEADING ON
DELETE FROM USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'GEODPOINT3D'; 
COMMIT;
DECLARE
  v_shape mdsys.sdo_geometry;
BEGIN
  SELECT SDO_AGGR_MBR(geom) INTO v_shape FROM GEODPOINT3D;
  INSERT INTO USER_SDO_GEOM_METADATA(TABLE_NAME,COLUMN_NAME,DIMINFO,SRID)
    VALUES ('GEODPOINT3D','GEOM',MDSYS.SDO_DIM_ARRAY(
    MDSYS.SDO_DIM_ELEMENT('Longitude',V_SHAPE.SDO_ORDINATES(1),V_SHAPE.SDO_ORDINATES(4),0.05),
    MDSYS.SDO_DIM_ELEMENT('Latitude' ,V_SHAPE.SDO_ORDINATES(2),V_SHAPE.SDO_ORDINATES(5),0.05),
    MDSYS.SDO_DIM_ELEMENT('Z'        ,V_SHAPE.SDO_ORDINATES(3),V_SHAPE.SDO_ORDINATES(6),0.5)),8311);
END;
/
SHOW ERRORS
SELECT diminfo FROM USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'GEODPOINT3D'; 
DROP INDEX GEODPOINT3D_Geom;
CREATE INDEX GEODPOINT3D_Geom on GEODPOINT3D(geom) 
       indextype is mdsys.spatial_index 
       parameters('sdo_indx_dims=2, layer_gtype=point');

-- *******************************************************************************************************

DROP   TABLE GeodPoly2D  PURGE;
CREATE TABLE GeodPoly2D ( PolyType VARCHAR2(40), geom mdsys.sdo_geometry );
INSERT INTO  GeodPoly2D 
VALUES ( 'SIMPLE', 
MDSYS.SDO_GEOMETRY(2003, 8265, NULL, 
MDSYS.SDO_ELEM_INFO_ARRAY(1, 1003, 1),
MDSYS.SDO_ORDINATE_ARRAY(
-79.230383, 35.836761, -79.230381, 35.836795, -79.230414, 35.83683, -79.230468, 35.836857, 
-79.230502, 35.836878, -79.23055, 35.836906, -79.23059, 35.836922,  -79.230617, 35.836945,
-79.230658, 35.836966, -79.230671, 35.837005, -79.230698, 35.837048, -79.230704, 35.837082, 
-79.230712, 35.83712, -79.230711, 35.837192, -79.230725, 35.83722, -79.230779, 35.837247, 
-79.230792, 35.837202, -79.230785, 35.837114, -79.23078, 35.837087, -79.230765, 35.837038,
-79.230718, 35.836972, -79.230671, 35.836917, -79.230637, 35.8369, -79.23061, 35.836873,
-79.230583, 35.83685, -79.230529, 35.836818, -79.230489, 35.83679, -79.230456, 35.836774, -79.230383, 35.836761)));
COMMIT;
DELETE FROM USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'GEODPOLY2D'; 
COMMIT;
DECLARE
  v_shape mdsys.sdo_geometry;
BEGIN
  SELECT SDO_AGGR_MBR(geom) INTO v_shape FROM GEODPOLY2D;
  INSERT INTO USER_SDO_GEOM_METADATA(TABLE_NAME,COLUMN_NAME,DIMINFO,SRID)
    VALUES ('GEODPOLY2D',
            'GEOM',
            MDSYS.SDO_DIM_ARRAY(
                MDSYS.SDO_DIM_ELEMENT('X',V_SHAPE.SDO_ORDINATES(1),V_SHAPE.SDO_ORDINATES(3),0.05),
                MDSYS.SDO_DIM_ELEMENT('Y',V_SHAPE.SDO_ORDINATES(2),V_SHAPE.SDO_ORDINATES(4),0.05)),
            8265);
END;
/
SHOW ERRORS
SELECT diminfo FROM USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'GEODPOLY2D'; 
DROP INDEX GEODPOLY2D_Geom;
CREATE INDEX GEODPOLY2D_Geom on GEODPOLY2D(geom) 
       indextype is mdsys.spatial_index 
       parameters('sdo_indx_dims=2, layer_gtype=polygon');

-- *****************************************************************************

Drop Table Oriented_Point;
Create Table oriented_point (id number, Geom Sdo_Geometry);

insert into oriented_point (id,geom) values(4   ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42781396.2001512,457837132.60015,0,0.866186951907965,0.499720085992537,0)));
insert into oriented_point (id,geom) values(5   ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42792668.4002372,457751297.79978,0,0.901190729167113,-0.433422737824456,0)));
insert into oriented_point (id,geom) values(6   ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42667160.399947,457538468.700236,0,0.428026479913496,0.903766193488594,0)));
insert into oriented_point (id,geom) values(7   ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42718894.599856,457647416.600053,0,0.42815897572778,0.903703431167404,0)));
insert into oriented_point (id,geom) values(8   ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42611295.9003171,457662210.400047,0,0.899203704554947,-0.437530224915559,0)));
insert into oriented_point (id,geom) values(9   ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42689117.6003236,457624436.599882,0,0.899131824703949,-0.437677920170241,0)));
insert into oriented_point (id,geom) values(10  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42578371.9002364,457584580.400213,0,-0.458147322446748,0.888876274255802,0)));
insert into oriented_point (id,geom) values(11  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42576686.8003421,457648016.299926,0,0.0476250064202492,0.998865285593343,0)));
insert into oriented_point (id,geom) values(12  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42689623.3000174,457533376.699752,0,0.432077614330499,0.901836423745717,0)));
insert into oriented_point (id,geom) values(13  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42738282.7998623,457636926.800073,0,0.432109446059973,0.901821172198648,0)));
insert into oriented_point (id,geom) values(14  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42714357.800184,457609597.099871,0,0.903147173724776,-0.429331087382395,0)));
insert into oriented_point (id,geom) values(15  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42755707.2997359,457590167.599978,0,0.903093173438935,-0.429444664756699,0)));
insert into oriented_point (id,geom) values(16  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42595136.4997528,457562590.499812,0,0.701050436240618,-0.713111692406484,0)));
insert into oriented_point (id,geom) values(17  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42649943.0998217,457529070.700074,0,0.814219165191775,-0.580557620770246,0)));
insert into oriented_point (id,geom) values(18  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42742222.8998825,457657044.699892,0,0.901367188146727,-0.433055645538148,0)));
insert into oriented_point (id,geom) values(19  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42785448.8999858,457635923.800147,0,0.901402330392483,-0.43298249244398,0)));
insert into oriented_point (id,geom) values(20  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42645016.1997681,457544860.899796,0,0.428887615928739,0.903357854287525,0)));
insert into oriented_point (id,geom) values(21  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42673869.2997332,457605848.799862,0,0.42893990781684,0.903333025789537,0)));
insert into oriented_point (id,geom) values(22  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42609108.5003045,457682493.599973,0,0.917592159391778,0.39752311759536,0)));
insert into oriented_point (id,geom) values(23  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42639149.8000096,457696094.599694,0,0.917601991989816,0.397500420498296,0)));
insert into oriented_point (id,geom) values(24  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42661326.9997281,457708634.700357,0,0.937151463724862,0.348922819601052,0)));
insert into oriented_point (id,geom) values(25  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42720677.6999832,457667302.499645,0,0.90133464237071,-0.43312338018452,0)));
insert into oriented_point (id,geom) values(26  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42666479.6998888,457693719.100208,0,0.901404451709579,-0.432978076163392,0)));
insert into oriented_point (id,geom) values(27  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42700916.6000436,457726451.999871,0,0.900107297124788,0.435668283976133,0)));
insert into oriented_point (id,geom) values(28  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42769907.1000598,457758797.200342,0,0.903178916071127,0.429264307349894,0)));
insert into oriented_point (id,geom) values(29  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42726105.699922,457765433.799644,0,0.910535802478594,0.413430226767059,0)));
insert into oriented_point (id,geom) values(30  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42760797.9003093,457781108.400054,0,0.910566197801438,0.41336327778533,0)));
insert into oriented_point (id,geom) values(31  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42787789.1998665,457798116.299641,0,0.581870294946965,0.813281599360475,0)));
insert into oriented_point (id,geom) values(32  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42777725.5998672,457830794.599908,0,-0.548389560622166,0.836222990476002,0)));
insert into oriented_point (id,geom) values(33  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42767949.2998075,457846917.400233,0,-0.548393001336794,0.83622073406776,0)));
insert into oriented_point (id,geom) values(34  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42547459.2001328,457710601.899904,0,0.999928297660517,-0.0119749546028632,0)));
insert into oriented_point (id,geom) values(35  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42597550.699705,457706237.099652,0,0.988795284780353,-0.149277877785494,0)));
insert into oriented_point (id,geom) values(36  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42755650.6999512,457872110.900243,0,-0.475369336892883,0.879786334027769,0)));
insert into oriented_point (id,geom) values(37  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42760851.200357,457541741.299869,0,0.430855663965527,0.902420853498424,0)));
insert into oriented_point (id,geom) values(38  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42793214.9997396,457611387.200273,0,0.41926234942816,0.907865123436284,0)));
insert into oriented_point (id,geom) values(39  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42791845.7000778,457810399.399922,0,-0.548391421751044,0.83622176995691,0)));
insert into oriented_point (id,geom) values(40  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42748912.4997167,458100888.800304,0,0.999998306834155,0.00184019803928363,0)));
commit;

DELETE FROM USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'ORIENTED_POINT'; 
COMMIT;
DECLARE
  v_shape mdsys.sdo_geometry;
BEGIN
  SELECT SDO_AGGR_MBR(geom) INTO v_shape FROM GEODPoint3D;
  INSERT INTO USER_SDO_GEOM_METADATA(TABLE_NAME,COLUMN_NAME,DIMINFO,SRID)
    VALUES ('ORIENTED_POINT',
            'GEOM',
            MDSYS.SDO_DIM_ARRAY(
                MDSYS.SDO_DIM_ELEMENT('X',V_SHAPE.SDO_ORDINATES(1),V_SHAPE.SDO_ORDINATES(4),0.05),
                MDSYS.SDO_DIM_ELEMENT('Y',V_SHAPE.SDO_ORDINATES(2),V_SHAPE.SDO_ORDINATES(5),0.05),
                MDSYS.SDO_DIM_ELEMENT('Z',V_SHAPE.SDO_ORDINATES(3),V_SHAPE.SDO_ORDINATES(6),0.5)),
            NULL);
END;
/
SHOW ERRORS
SELECT diminfo FROM USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'ORIENTED_POINT'; 
DROP INDEX ORIENTED_POINT_Geom;
CREATE INDEX ORIENTED_POINT_Geom on ORIENTED_POINT(geom) 
       indextype is mdsys.spatial_index 
       parameters('sdo_indx_dims=3, layer_gtype=point');

purge recyclebin;
EXIT;
=======
set serveroutput on size unlimited

DROP   TABLE ProjPoint2D  PURGE;
CREATE TABLE ProjPoint2D ( id integer, label varchar2(20), angleDegrees number, geom mdsys.sdo_geometry );
SET FEEDBACK OFF
    INSERT INTO ProjPoint2D (id, label, angleDegrees, geom)
      SELECT rownum,
             CHR(dbms_random.value(65,90)) || to_char(round(dbms_random.value(0,1000),0),'FM9999') as label,
             ROUND(dbms_random.value(0,359.9),1) as angleDegrees,
             mdsys.sdo_geometry(2001,NULL,
                   MDSYS.SDO_POINT_TYPE(
                         ROUND(dbms_random.value(358880  - ( 10000 / 2 ),  
                                                 358880  + ( 10000 / 2 )),2),
                         ROUND(dbms_random.value(5407473 - (  5000 / 2 ), 
                                                 5407473 + (  5000 / 2 )),2),
                         NULL),
                   NULL,NULL)
       FROM DUAL
     CONNECT BY LEVEL <= 500; 
COMMIT;
SET FEEDBACK ON
SET HEADING OFF
SELECT 'Inserted '||count(*)||' records into ProjPoint2D' FROM ProjPoint2D;
SET HEADING ON
DELETE FROM USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'PROJPOINT2D'; 
COMMIT;
DECLARE
  v_shape mdsys.sdo_geometry;
BEGIN
  SELECT SDO_AGGR_MBR(geom) INTO v_shape FROM ProjPoint2D;
  INSERT INTO USER_SDO_GEOM_METADATA(TABLE_NAME,COLUMN_NAME,DIMINFO,SRID)
    VALUES ('PROJPOINT2D','GEOM',MDSYS.SDO_DIM_ARRAY(
    MDSYS.SDO_DIM_ELEMENT('X',V_SHAPE.SDO_ORDINATES(1),V_SHAPE.SDO_ORDINATES(3),0.05),
    MDSYS.SDO_DIM_ELEMENT('Y',V_SHAPE.SDO_ORDINATES(2),V_SHAPE.SDO_ORDINATES(4),0.05)),NULL);
END;
/
SHOW ERRORS
COMMIT;
CREATE INDEX ProjPoint2D_GEOM on ProjPoint2D(geom) 
       INDEXTYPE is mdsys.spatial_index 
       parameters('sdo_indx_dims=2, layer_gtype=point');

-- *******************************************************************************************************

DROP   TABLE ProjCircle2D  PURGE;
CREATE TABLE ProjCircle2D ( id integer, label varchar2(20), rgb varchar2(20), iRGB integer, geom mdsys.sdo_geometry );
SET FEEDBACK OFF
    INSERT INTO ProjCircle2D (id, label, rgb, iRGB, geom)
      SELECT rownum,
             CHR(dbms_random.value(65,90)) || to_char(round(dbms_random.value(0,1000),0),'FM9999') as label,
             ROUND(dbms_random.value(0,255),0) || ',' || ROUND(dbms_random.value(0,255),0) || ',' || ROUND(dbms_random.value(0,255),0) as rgb,
             power(2,16)* ROUND(dbms_random.value(0,255),0) + 
             power(2,8) * ROUND(dbms_random.value(0,255),0) + 
                          ROUND(dbms_random.value(0,255),0) as irgb,
		     mdsys.sdo_geometry(2003,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1003,4),
                                sdo_ordinate_array(x+2.0*radius,y,x+radius,y+radius,X,Y)) as geom 
       FROM (SELECT ROUND(dbms_random.value(358880  - ( 10000 / 2 ),  
                                            358880  + ( 10000 / 2 )),2) as x,
                    ROUND(dbms_random.value(5407473 - (  5000 / 2 ), 
                                            5407473 + (  5000 / 2 )),2) as y,
                    dbms_random.value(10,100) as radius
              FROM DUAL
           CONNECT BY LEVEL <= 500
        ) f; 
COMMIT;
SET FEEDBACK ON
SET HEADING OFF
SELECT 'Inserted '||count(*)||' records into ProjCircle2D' FROM ProjCircle2D;
SET HEADING ON
DELETE FROM USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'PROJCIRCLE2D'; 
COMMIT;
DECLARE
  v_shape mdsys.sdo_geometry;
BEGIN
  SELECT SDO_AGGR_MBR(geom) INTO v_shape FROM ProjCircle2D;
  INSERT INTO USER_SDO_GEOM_METADATA(TABLE_NAME,COLUMN_NAME,DIMINFO,SRID)
    VALUES ('PROJCIRCLE2D','GEOM',MDSYS.SDO_DIM_ARRAY(
    MDSYS.SDO_DIM_ELEMENT('X',V_SHAPE.SDO_ORDINATES(1),V_SHAPE.SDO_ORDINATES(2),0.05),
    MDSYS.SDO_DIM_ELEMENT('Y',V_SHAPE.SDO_ORDINATES(3),V_SHAPE.SDO_ORDINATES(4),0.05)),NULL);
END;
/
SHOW ERRORS
COMMIT;
CREATE INDEX ProjCircle2D_GEOM on ProjCircle2D(geom) 
       INDEXTYPE is mdsys.spatial_index 
       parameters('sdo_indx_dims=2, layer_gtype=polygon');

-- *******************************************************************************************************

DROP   TABLE ProjLine2D PURGE;
CREATE TABLE ProjLine2D ( linetype varchar2(40), geom mdsys.sdo_geometry );
INSERT INTO  ProjLine2D 
VALUES('VERTEXARC',
MDSYS.SDO_GEOMETRY(2002,NULL,NULL,
mdsys.sdo_elem_info_array(1,4,2,1,2,1,3,2,2),
MDSYS.SDO_ORDINATE_ARRAY(252000,5526000,252700,5526700,252500,5526700,252500,5526500)));
INSERT INTO ProjLine2D 
VALUES('VERTEX',
MDSYS.SDO_GEOMETRY(2002, NULL, NULL, 
      MDSYS.SDO_ELEM_INFO_ARRAY(1, 2, 1), 
      MDSYS.SDO_ORDINATE_ARRAY( 380326.792, 5167089.286, 380326.792, 5167889.286, 380826.792, 5167889.286, 380126.792, 5167489.286)));
INSERT INTO ProjLine2D 
VALUES('STRAIGHTVERTEX',
      MDSYS.SDO_GEOMETRY(2002, NULL, NULL, 
      MDSYS.SDO_ELEM_INFO_ARRAY(1, 2, 1), 
      MDSYS.SDO_ORDINATE_ARRAY( 380000.0, 5100000.0, 380000.0, 5160000.0)));
INSERT INTO ProjLine2D 
VALUES('45DEGREEVERTEX',
      MDSYS.SDO_GEOMETRY(2002, NULL, NULL, 
      MDSYS.SDO_ELEM_INFO_ARRAY(1, 2, 1), 
      MDSYS.SDO_ORDINATE_ARRAY( 380000.0, 5100000.0, 390000.0, 5110000.0)));
INSERT INTO ProjLine2D(LINETYPE,GEOM)
VALUES('DUPLICATEVERTEX',
      MDSYS.SDO_GEOMETRY(2002,null,null,
      MDSYS.SDO_ELEM_INFO_ARRAY(1,2,1),
      MDSYS.SDO_ORDINATE_ARRAY( 380000,5100000, 380000.001,5100000, 390000,5110000)));
COMMIT;
DELETE FROM USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'PROJLINE2D';
COMMIT;
DECLARE
  v_shape mdsys.sdo_geometry;
BEGIN
  SELECT SDO_AGGR_MBR(geom) INTO v_shape FROM ProjLine2D;
  INSERT INTO USER_SDO_GEOM_METADATA(TABLE_NAME,COLUMN_NAME,DIMINFO,SRID)
    VALUES ('PROJLINE2D','GEOM',MDSYS.SDO_DIM_ARRAY(
    MDSYS.SDO_DIM_ELEMENT('X',V_SHAPE.SDO_ORDINATES(1),V_SHAPE.SDO_ORDINATES(2),0.05),
    MDSYS.SDO_DIM_ELEMENT('Y',V_SHAPE.SDO_ORDINATES(3),V_SHAPE.SDO_ORDINATES(4),0.05)),NULL);
END;
/
SHOW ERRORS
COMMIT;
CREATE INDEX ProjLine2D_Geom on ProjLine2D(geom) 
       INDEXTYPE is mdsys.spatial_index 
       parameters('sdo_indx_dims=2, layer_gtype=line');

-- *******************************************************************************************************

DROP   TABLE ProjMultiLine2D  PURGE;
CREATE TABLE ProjMultiLine2D ( id integer, label varchar2(20), angleDegrees number, geom mdsys.sdo_geometry );
SET FEEDBACK OFF
    INSERT INTO ProjMultiLine2D (id, label, angleDegrees, geom)
      SELECT rownum,
             CHR(dbms_random.value(65,90)) || to_char(round(dbms_random.value(0,1000),0),'FM9999') as label,
             ROUND(dbms_random.value(0,359.9),1) as angleDegrees,
             mdsys.sdo_geometry(2006,NULL,NULL,MDSYS.SDO_ELEM_INFO_ARRAY(1,2,1,5,2,1),
                   MDSYS.SDO_ORDINATE_ARRAY(
                         ROUND(dbms_random.value(358880  - ( 10000 / 2 ),  358880  + ( 10000 / 2 )),2),
                         ROUND(dbms_random.value(5407473 - (  5000 / 2 ), 5407473 + (  5000 / 2 )),2),
                         ROUND(dbms_random.value(358880  - ( 10000 / 2 ),  358880  + ( 10000 / 2 )),2),
                         ROUND(dbms_random.value(5407473 - (  5000 / 2 ), 5407473 + (  5000 / 2 )),2),
                         ROUND(dbms_random.value(358880  - ( 10000 / 2 ),  358880  + ( 10000 / 2 )),2),
                         ROUND(dbms_random.value(5407473 - (  5000 / 2 ), 5407473 + (  5000 / 2 )),2),
                         ROUND(dbms_random.value(358880  - ( 10000 / 2 ),  358880  + ( 10000 / 2 )),2),
                         ROUND(dbms_random.value(5407473 - (  5000 / 2 ), 5407473 + (  5000 / 2 )),2))
                   )
       FROM DUAL
     CONNECT BY LEVEL <= 500; 
COMMIT;
SET FEEDBACK ON
SET HEADING OFF
SELECT 'Inserted '||count(*)||' records into ProjMultiLine2D' FROM ProjMultiLine2D;
SET HEADING ON
DELETE FROM USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'PROJMULTILINE2D'; 
COMMIT;
DECLARE
  v_shape mdsys.sdo_geometry;
BEGIN
  SELECT SDO_AGGR_MBR(geom) INTO v_shape FROM ProjMultiLine2D;
  INSERT INTO USER_SDO_GEOM_METADATA(TABLE_NAME,COLUMN_NAME,DIMINFO,SRID)
    VALUES ('PROJMULTILINE2D','GEOM',MDSYS.SDO_DIM_ARRAY(
    MDSYS.SDO_DIM_ELEMENT('X',V_SHAPE.SDO_ORDINATES(1),V_SHAPE.SDO_ORDINATES(2),0.05),
    MDSYS.SDO_DIM_ELEMENT('Y',V_SHAPE.SDO_ORDINATES(3),V_SHAPE.SDO_ORDINATES(4),0.05)),NULL);
END;
/
SHOW ERRORS
COMMIT;
CREATE INDEX ProjMultiLine2D_GEOM on ProjMultiLine2D(geom) 
       INDEXTYPE is mdsys.spatial_index 
       parameters('sdo_indx_dims=2, layer_gtype=multiline');

-- *******************************************************************************************************

DROP   TABLE ProjPoly2D PURGE;
CREATE TABLE ProjPoly2D ( polytype varchar2(40), geom mdsys.sdo_geometry );
INSERT INTO  ProjPoly2D (PolyType,Geom) 
VALUES( 'VERTEXWITHHOLE', MDSYS.SDO_GEOMETRY(2003, NULL, NULL, 
       MDSYS.SDO_ELEM_INFO_ARRAY(1, 1003, 1, 77, 2003, 1), 
       MDSYS.SDO_ORDINATE_ARRAY(
524570.7, 5202359.4, 524267.6, 5202035.7, 524720, 5201928.8, 524725.1, 5201939.5, 
524739.1, 5201953.4, 524752.6, 5201964.8, 524766, 5201976.2, 524783.1, 5201991.4,
524797.6, 5202011.7, 524804.6, 5202025, 524815, 5202040.8, 524815.6, 5202042.1,
524820.6, 5202052.9, 524825.9, 5202063.1, 524834.6, 5202085.3, 524843.6, 5202099.9,
524853.9, 5202114.5, 524864.6, 5202124.6, 524868.6, 5202130, 524876.1, 5202139.8,
524890.1, 5202158.2, 524903, 5202177.8, 524914.4, 5202194.3, 524925.9, 5202214.7,
524933.5, 5202228, 524945.6, 5202245.1, 524959, 5202260.3, 524968.6, 5202276.2,
524976.9, 5202289.5, 524984.5, 5202299.6, 524987.6, 5202304.1, 524995.4, 5202314.8, 
525005.5, 5202329.5, 525016.4, 5202343.4, 525022.6, 5202354.2, 525023.2, 5202355,
524976.5, 5202359.4, 524570.7, 5202359.4,
524548.319747, 5202136.448354,
524548.319747, 5202227.311646,
524738.654430, 5202227.311646,
524738.654430, 5202136.448354,
524548.319747, 5202136.448354
)));
INSERT INTO ProjPoly2D (PolyType,Geom) VALUES( 'VERTEXNOHOLE',
MDSYS.SDO_GEOMETRY(2003, NULL, NULL, 
MDSYS.SDO_ELEM_INFO_ARRAY(1, 1003, 1), 
MDSYS.SDO_ORDINATE_ARRAY(
361347.064, 5407661.54, 361310.469, 5407666.59, 361292.253, 5407663.80, 361249.719, 5407657.28, 
361171.344, 5407642.41, 361047.094, 5407631.34, 360960.656, 5407631.50, 360853.937, 5407628.56, 
360757.281, 5407630.97, 360693.594, 5407634.31, 360617.250, 5407637.28, 360540.969, 5407637.72, 
360457.125, 5407635.41, 360398.562, 5407638.88, 360371.128, 5407638.58, 360273.506, 5407637.55, 
360248.594, 5407637.28, 360167.312, 5407635.06, 360113.937, 5407633.59, 360017.719, 5407620.75, 
359893.687, 5407602.06, 359775.031, 5407573.31, 359631.344, 5407531.19, 359478.756, 5407504.41, 
359459.344, 5407501.00, 359449.272, 5407500.04, 359448.678, 5407499.98, 359309.750, 5407486.69, 
359183.125, 5407470.47, 359074.031, 5407462.34, 358959.719, 5407459.19, 358868.094, 5407461.75, 
358776.474, 5407468.17, 358763.656, 5407469.06, 358669.807, 5407482.06, 358641.125, 5407486.03, 
358523.219, 5407518.41, 358436.094, 5407541.47, 358400.812, 5407553.12, 358343.656, 5407572, 
358243.469, 5407607.41, 358150.969, 5407640.47, 358061.000, 5407673.63, 357966.281, 5407696.47, 
357853.750, 5407718.81, 357787.094, 5407737.31, 357705.375, 5407750.34, 357595.594, 5407765.13, 
357541.875, 5407776.38, 357490.687, 5407787.69, 357423.906, 5407811.28, 357352.031, 5407834.75, 
357336.562, 5407841.97, 357280.219, 5407855.66, 357257.219, 5407860.13, 357203.562, 5407868.81, 
357160.219, 5407872.72, 357075.719, 5407893.28, 357019.594, 5407899.38, 356973.812, 5407900.66,
356920.687, 5407891.56, 356893.250, 5407872.97, 356858.594, 5407841.50, 356836.844, 5407802.72,
356817.719, 5407761.47, 356786.250, 5407707.16, 356748.969, 5407678.13, 356718.875, 5407664.56, 
356693.469, 5407663.88, 356670.594, 5407663.25, 356642.812, 5407657.38, 356623.000, 5407639.03,
356589.156, 5407579.56, 356562.250, 5407543.19, 356562.312, 5407540.63, 356601.031, 5407521.34,
356606.469, 5407508.78, 356632.719, 5407481.50, 356638.156, 5407468.94, 356648.531, 5407461.56,
356679.625, 5407442.06, 356718.187, 5407427.88, 356728.344, 5407428.16, 356758.687, 5407434.06,
356776.375, 5407437.09, 356791.562, 5407440.06, 356814.125, 5407450.88, 356823.969, 5407461.31, 
356866.062, 5407500.66, 356868.531, 5407503.28, 356913.562, 5407527.44, 356946.062, 5407546.13,
357031.344, 5407586.66, 357074.062, 5407603.13, 357124.562, 5407614.69, 357162.531, 5407620.81,
357197.937, 5407626.91, 357274.312, 5407623.91, 357356.062, 5407610.91, 357427.344, 5407607.78,
357513.844, 5407605.06, 357567.562, 5407593.84, 357659.781, 5407570.94, 357746.969, 5407545.34,
357821.469, 5407519.41, 357916.937, 5407471.13, 357947.569, 5407456.85, 358009.750, 5407427.88, 
358105.000, 5407387.25, 358205.656, 5407336.59, 358277.906, 5407300.41, 358424.719, 5407235.75,
358546.548, 5407182.59, 358550.906, 5407180.69, 358653.594, 5407147.91, 358695.565, 5407138.62,
358786.656, 5407118.47, 358890.875, 5407118.81, 358974.562, 5407126.22, 359032.687, 5407138,
359136.469, 5407153.59, 359245.344, 5407169.31, 359301.750, 5407153.06, 359335.531, 5407128.53,
359385.500, 5407071.38, 359476.812, 5406992.47, 359565.281, 5406923.66, 359616.750, 5406902.16, 
359693.187, 5406896.66, 359810.062, 5406899.88, 359872.914, 5406915.92, 359888.281, 5406919.84,
360011.625, 5406961.44, 360086.812, 5406999.13, 360171.844, 5407047.28, 360241.687, 5407092.47,
360308.875, 5407142.69, 360368.781, 5407179.97, 360439.094, 5407209.91, 360519.719, 5407235.03,
360590.781, 5407239.53, 360679.844, 5407236.91, 360761.812, 5407216.28, 360849.000, 5407190.69,
360948.906, 5407165.44, 361020.469, 5407152.16, 361101.781, 5407154.41, 361211.094, 5407154.88, 
361294.844, 5407159.72, 361373.594, 5407161.91, 361421.500, 5407175.94, 361471.687, 5407197.69,
361491.437, 5407218.59, 361540.156, 5407291.19, 361546.812, 5407324.47, 361540.720, 5407383.04,
361540.047, 5407389.51, 361539.687, 5407392.97, 361530.969, 5407430.91, 361514.375, 5407476.28,
361489.875, 5407531.59, 361470.750, 5407576.88, 361444.281, 5407611.75, 361402.812, 5407638.63,
361356.437, 5407660.25, 361347.064, 5407661.54)));
INSERT INTO ProjPoly2D
VALUES( 'VERTEXNOHOLE',
MDSYS.SDO_GEOMETRY(2003, NULL, NULL, 
MDSYS.SDO_ELEM_INFO_ARRAY(1, 1003, 1),
MDSYS.SDO_ORDINATE_ARRAY(
476400.000, 237700.000, 475879.950, 237700.000, 475939.060, 237634.800, 476002.840, 237573.450,
476045.530, 237559.550, 476087.000, 237545.060, 476135.250, 237525.530, 476155.500, 237517.380,
476170.250, 237509.000, 476182.690, 237494.470, 476226.190, 237551.520, 476342.910, 237515.520,
476400.000, 237494.926, 476400.000, 237700.000)));
Prompt Simple outer shell made up of 3 vertex-to-vertex line finishing with circular arc
INSERT INTO ProjPoly2D
VALUES( 'COMPOUNDOUTERSHELL',
MDSYS.SDO_GEOMETRY(2003,NULL,NULL,
    MDSYS.SDO_ELEM_INFO_ARRAY(1,1005,2,1,2,1,5,2,2),
    MDSYS.SDO_ORDINATE_ARRAY(
    253014,5527010, 253010,5527001, 253006,5527011, 253010,5527011, 253014,5527010)));
INSERT INTO ProjPoly2D (PolyType,Geom) VALUES( 'VERTEXNOHOLE',
MDSYS.SDO_GEOMETRY(2003, NULL, NULL, 
MDSYS.SDO_ELEM_INFO_ARRAY(1, 1003, 1), 
MDSYS.SDO_ORDINATE_ARRAY(
524570.7, 5202359.4, 524267.6, 5202035.7, 524720.0, 5201928.8, 524725.1, 5201939.5, 
524739.1, 5201953.4, 524752.6, 5201964.8, 524766.0, 5201976.2, 524783.1, 5201991.4,
524797.6, 5202011.7, 524804.6, 5202025.0, 524815.0, 5202040.8, 524815.6, 5202042.1,
524820.6, 5202052.9, 524825.9, 5202063.1, 524834.6, 5202085.3, 524843.6, 5202099.9,
524853.9, 5202114.5, 524864.6, 5202124.6, 524868.6, 5202130.0, 524876.1, 5202139.8,
524890.1, 5202158.2, 524903.0, 5202177.8, 524914.4, 5202194.3, 524925.9, 5202214.7,
524933.5, 5202228.0, 524945.6, 5202245.1, 524959.0, 5202260.3, 524968.6, 5202276.2,
524976.9, 5202289.5, 524984.5, 5202299.6, 524987.6, 5202304.1, 524995.4, 5202314.8, 
525005.5, 5202329.5, 525016.4, 5202343.4, 525022.6, 5202354.2, 525023.2, 5202355.0,
524976.5, 5202359.4, 524570.7, 5202359.4)));
INSERT INTO ProjPoly2D (PolyType,Geom) 
VALUES( 'VERTEXWITHARCNOHOLE',
    MDSYS.SDO_GEOMETRY(2003,NULL,NULL,
    MDSYS.SDO_ELEM_INFO_ARRAY(1,1005,2,1,2,1,5,2,2),
    MDSYS.SDO_ORDINATE_ARRAY(
    253014,5527010, 253010,5527001, 253006,5527011, 253010,5527011, 253014,5527010))
);
INSERT INTO ProjPoly2D (PolyType,Geom) 
VALUES( 'NORMALISEDRECTANGLENOHOLE',
MDSYS.SDO_GEOMETRY(2003, NULL, NULL, 
MDSYS.SDO_ELEM_INFO_ARRAY(1, 1003, 3), 
MDSYS.SDO_ORDINATE_ARRAY(190000,5120000,640000,5630000)));
INSERT INTO ProjPoly2D (PolyType,Geom) 
VALUES( 'CURVEPOLYWITHHOLE',
MDSYS.SDO_GEOMETRY(2003,NULL,NULL,
MDSYS.SDO_ELEM_INFO_ARRAY(1,1003,4,7,2003,4),
MDSYS.SDO_ORDINATE_ARRAY(253000,5527000,252000,5527000,252000,5526000,252700,5526700,252500,5526700,252500,5526500)));

DELETE FROM USER_SDO_GEOM_METADATA WHERE Table_name = 'PROJPOLY2D'; 
COMMIT;
DECLARE
  v_shape mdsys.sdo_geometry;
BEGIN
  SELECT SDO_AGGR_MBR(geom) INTO v_shape FROM ProjPoly2D;
  INSERT INTO USER_SDO_GEOM_METADATA(TABLE_NAME,COLUMN_NAME,DIMINFO,SRID)
    VALUES ('PROJPOLY2D','GEOM',MDSYS.SDO_DIM_ARRAY(
    MDSYS.SDO_DIM_ELEMENT('X',V_SHAPE.SDO_ORDINATES(1),V_SHAPE.SDO_ORDINATES(2),0.05),
    MDSYS.SDO_DIM_ELEMENT('Y',V_SHAPE.SDO_ORDINATES(3),V_SHAPE.SDO_ORDINATES(4),0.05)),NULL);
END;
/
SHOW ERRORS
COMMIT;
CREATE INDEX ProjPoly2D_Geom on ProjPoly2D(geom) 
       INDEXTYPE is mdsys.spatial_index 
       parameters('sdo_indx_dims=2, layer_gtype=polygon');

-- **********************************************************************************

DROP   TABLE ProjMultiPoly2D  PURGE;
CREATE TABLE ProjMultiPoly2D ( id integer, label varchar2(20), angleDegrees number, geom mdsys.sdo_geometry );
SET FEEDBACK OFF
    INSERT INTO ProjMultiPoly2D (id, label, angleDegrees, geom)
      SELECT rownum,
             CHR(dbms_random.value(65,90)) || to_char(round(dbms_random.value(0,1000),0),'FM9999') as label,
             ROUND(dbms_random.value(0,359.9),1) as angleDegrees,
             mdsys.sdo_geometry(2007,NULL,NULL,MDSYS.SDO_ELEM_INFO_ARRAY(1,1003,3,5,1003,3),
                   MDSYS.SDO_ORDINATE_ARRAY(
                         ROUND(dbms_random.value(358880  - ( 10000 / 2 ),  358880  + ( 10000 / 2 )),2),
                         ROUND(dbms_random.value(5407473 - (  5000 / 2 ), 5407473 + (  5000 / 2 )),2),
                         ROUND(dbms_random.value(358880  - ( 10000 / 2 ),  358880  + ( 10000 / 2 )),2),
                         ROUND(dbms_random.value(5407473 - (  5000 / 2 ), 5407473 + (  5000 / 2 )),2),
                         ROUND(dbms_random.value(358880  - ( 10000 / 2 ),  358880  + ( 10000 / 2 )),2),
                         ROUND(dbms_random.value(5407473 - (  5000 / 2 ), 5407473 + (  5000 / 2 )),2),
                         ROUND(dbms_random.value(358880  - ( 10000 / 2 ),  358880  + ( 10000 / 2 )),2),
                         ROUND(dbms_random.value(5407473 - (  5000 / 2 ), 5407473 + (  5000 / 2 )),2))
                   )
       FROM DUAL
     CONNECT BY LEVEL <= 500; 
COMMIT;
SET FEEDBACK ON
SET HEADING OFF
SELECT 'Inserted '||count(*)||' records into ProjMultiPoly2D' FROM ProjMultiPoly2D;
SET HEADING ON
DELETE FROM USER_SDO_GEOM_METADATA WHERE TABLE_NAME = upper('ProjMultiPoly2D'); 
COMMIT;
DECLARE
  v_shape mdsys.sdo_geometry;
BEGIN
  SELECT SDO_AGGR_MBR(geom) INTO v_shape FROM ProjMultiPoly2D;
  INSERT INTO USER_SDO_GEOM_METADATA(TABLE_NAME,COLUMN_NAME,DIMINFO,SRID)
    VALUES (upper('ProjMultiPoly2D'),'GEOM',MDSYS.SDO_DIM_ARRAY(
    MDSYS.SDO_DIM_ELEMENT('X',V_SHAPE.SDO_ORDINATES(1),V_SHAPE.SDO_ORDINATES(3),0.05),
    MDSYS.SDO_DIM_ELEMENT('Y',V_SHAPE.SDO_ORDINATES(2),V_SHAPE.SDO_ORDINATES(4),0.05)),NULL);
END;
/
SHOW ERRORS
COMMIT;
CREATE INDEX ProjMultiPoly2D_GEOM on ProjMultiPoly2D(geom) 
       INDEXTYPE is mdsys.spatial_index 
       parameters('sdo_indx_dims=2, layer_gtype=multipolygon');

-- *********************************************************************************

DROP   TABLE ProjCompound2D PURGE;
CREATE TABLE ProjCompound2D ( geom  mdsys.sdo_geometry );
INSERT INTO  ProjCompound2D 
VALUES(
MDSYS.SDO_GEOMETRY(2004,NULL,NULL,
MDSYS.SDO_ELEM_INFO_ARRAY(1,1005,2,1,2,1,5,2,2),
MDSYS.SDO_ORDINATE_ARRAY(253006,5527010,253010,5527001,253014,5527010,253010,5527014,253006,5527010)) );
INSERT INTO ProjCompound2D 
VALUES(
MDSYS.SDO_GEOMETRY(2004, NULL, NULL, 
MDSYS.SDO_ELEM_INFO_ARRAY(1, 2, 1, 63, 2, 1, 113, 1003, 1, 189, 2003, 1), 
MDSYS.SDO_ORDINATE_ARRAY(
524769.7, 5202553.8,
524771.1, 5202553.2,
524781.4, 5202550,
524791, 5202547.4,
524802.4, 5202545.5,
524826.5, 5202541,
524834.1, 5202539.1,
524840.5, 5202536.5,
524852.5, 5202532.7,
524865.9, 5202527.6,
524870.1, 5202525.7,
524884.9, 5202517.5,
524900.1, 5202507.3,
524914.1, 5202498.3,
524924.9, 5202492.6,
524933.6, 5202488.8,
524944.5, 5202488.2,
524952.6, 5202486.9,
524966.6, 5202485,
524980.1, 5202483.7,
524992.6, 5202478.6, 
525005.5, 5202473.5, 
525015.6, 5202469, 
525028.1, 5202462.6, 
525048.3, 5202450.6, 
525056, 5202443, 
525057.9, 5202424, 
525053.4, 5202410, 
525043.6, 5202384.6, 
525036.1, 5202373.8, 
525023.2, 5202355,
524619.9, 5201690.4,
524621.6, 5201693.8,
524625.6, 5201698.3,
524632.6, 5201707.8,
524645.4, 5201726.8,
524649.1, 5201731.9,
524651.1, 5201735,
524653.6, 5201738.9,
524658.6, 5201745.8,
524664.5, 5201753.5,
524670.9, 5201767.4,
524674.6, 5201773.8,
524679.6, 5201788.4,
524679.6, 5201789,
524681.1, 5201797.3,
524683.6, 5201808,
524686.9, 5201818.8,
524695.6, 5201839.8,
524700.1, 5201851.2,
524704.6, 5201865.2,
524708, 5201882.3,
524711.6, 5201896.3,
524714.4, 5201909,
524717.6, 5201923.6,
524720, 5201928.8,
524570.7, 5202359.4,
524267.6, 5202035.7,
524720, 5201928.8,
524725.1, 5201939.5, 
524739.1, 5201953.4,
524752.6, 5201964.8,
524766, 5201976.2,
524783.1, 5201991.4,
524797.6, 5202011.7, 
524804.6, 5202025,
524815, 5202040.8,
524815.6, 5202042.1,
524820.6, 5202052.9,
524825.9, 5202063.1,
524834.6, 5202085.3,
524843.6, 5202099.9,
524853.9, 5202114.5,
524864.6, 5202124.6,
524868.6, 5202130,
524876.1, 5202139.8,
524890.1, 5202158.2, 
524903, 5202177.8,
524914.4, 5202194.3,
524925.9, 5202214.7,
524933.5, 5202228,
524945.6, 5202245.1,
524959, 5202260.3,
524968.6, 5202276.2,
524976.9, 5202289.5,
524984.5, 5202299.6,
524987.6, 5202304.1,
524995.4, 5202314.8, 
525005.5, 5202329.5, 
525016.4, 5202343.4, 
525022.6, 5202354.2, 
525023.2, 5202355,
524976.5, 5202359.4,
524570.7, 5202359.4,
524548.319747, 5202136.448354,
524548.319747, 5202227.311646,
524738.654430, 5202227.311646,
524738.654430, 5202136.448354,
524548.319747, 5202136.448354
)));
INSERT INTO PROJCOMPOUND2D 
VALUES(
MDSYS.SDO_GEOMETRY(2004, NULL, NULL,
MDSYS.SDO_ELEM_INFO_ARRAY(1, 1, 1, 3, 2, 1, 65, 2, 1, 115, 1003, 1, 191, 2003, 1),
MDSYS.SDO_ORDINATE_ARRAY(
524760.0, 5202550.0,
524769.7, 5202553.8,
524771.1, 5202553.2,
524781.4, 5202550,
524791, 5202547.4,
524802.4, 5202545.5,
524826.5, 5202541,
524834.1, 5202539.1,
524840.5, 5202536.5,
524852.5, 5202532.7,
524865.9, 5202527.6,
524870.1, 5202525.7,
524884.9, 5202517.5,
524900.1, 5202507.3,
524914.1, 5202498.3,
524924.9, 5202492.6,
524933.6, 5202488.8,
524944.5, 5202488.2,
524952.6, 5202486.9,
524966.6, 5202485,
524980.1, 5202483.7,
524992.6, 5202478.6,
525005.5, 5202473.5,
525015.6, 5202469,
525028.1, 5202462.6,
525048.3, 5202450.6,
525056, 5202443,
525057.9, 5202424,
525053.4, 5202410,
525043.6, 5202384.6,
525036.1, 5202373.8,
525023.2, 5202355,
524619.9, 5201690.4,
524621.6, 5201693.8,
524625.6, 5201698.3,
524632.6, 5201707.8,
524645.4, 5201726.8,
524649.1, 5201731.9,
524651.1, 5201735,
524653.6, 5201738.9,
524658.6, 5201745.8,
524664.5, 5201753.5,
524670.9, 5201767.4,
524674.6, 5201773.8,
524679.6, 5201788.4,
524679.6, 5201789,
524681.1, 5201797.3,
524683.6, 5201808,
524686.9, 5201818.8,
524695.6, 5201839.8,
524700.1, 5201851.2,
524704.6, 5201865.2,
524708, 5201882.3,
524711.6, 5201896.3,
524714.4, 5201909,
524717.6, 5201923.6,
524720, 5201928.8,
524570.7, 5202359.4,
524267.6, 5202035.7,
524720, 5201928.8,
524725.1, 5201939.5,
524739.1, 5201953.4,
524752.6, 5201964.8,
524766, 5201976.2,
524783.1, 5201991.4,
524797.6, 5202011.7,
524804.6, 5202025,
524815, 5202040.8,
524815.6, 5202042.1,
524820.6, 5202052.9,
524825.9, 5202063.1,
524834.6, 5202085.3,
524843.6, 5202099.9,
524853.9, 5202114.5,
524864.6, 5202124.6,
524868.6, 5202130,
524876.1, 5202139.8,
524890.1, 5202158.2,
524903, 5202177.8,
524914.4, 5202194.3,
524925.9, 5202214.7,
524933.5, 5202228,
524945.6, 5202245.1,
524959, 5202260.3,
524968.6, 5202276.2,
524976.9, 5202289.5,
524984.5, 5202299.6,
524987.6, 5202304.1,
524995.4, 5202314.8,
525005.5, 5202329.5,
525016.4, 5202343.4,
525022.6, 5202354.2,
525023.2, 5202355,
524976.5, 5202359.4,
524570.7, 5202359.4,
524548.319747, 5202136.448354,
524548.319747, 5202227.311646,
524738.654430, 5202227.311646,
524738.654430, 5202136.448354,
524548.319747, 5202136.448354
)));
COMMIT;
DELETE FROM USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'PROJCOMPOUND2D'; 
COMMIT;
DECLARE
  v_shape mdsys.sdo_geometry;
BEGIN
  SELECT SDO_AGGR_MBR(geom) INTO v_shape FROM PROJCOMPOUND2D;
  INSERT INTO USER_SDO_GEOM_METADATA(TABLE_NAME,COLUMN_NAME,DIMINFO,SRID)
    VALUES ('PROJCOMPOUND2D',
            'GEOM',
            MDSYS.SDO_DIM_ARRAY(
                MDSYS.SDO_DIM_ELEMENT('X',V_SHAPE.SDO_ORDINATES(1),V_SHAPE.SDO_ORDINATES(3),0.05),
                MDSYS.SDO_DIM_ELEMENT('Y',V_SHAPE.SDO_ORDINATES(2),V_SHAPE.SDO_ORDINATES(4),0.05)),
            NULL);
END;
/
SHOW ERRORS
SELECT diminfo from USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'PROJCOMPOUND2D'; 
DROP INDEX PROJCOMPOUND2D_Geom;
CREATE INDEX PROJCOMPOUND2D_Geom on PROJCOMPOUND2D(geom) 
       indextype is mdsys.spatial_index 
       parameters('sdo_indx_dims=2, layer_gtype=collection');

-- ***********************************************************************************

DROP   TABLE PROJMULTIPOINT2D PURGE;
CREATE TABLE ProjMultiPoint2D ( gid integer, text varchar2(10), geom mdsys.sdo_geometry );
insert into projmultipoint2d (gid,text,geom)
select rownum as gid,
       'Group ' || gid as text,
       geom
  from (select trunc(dbms_random.value(1,10)) as gid, sdo_aggr_union(sdoaggrtype(geom,0.05)) as geom
          from projpoint2d p
        group by trunc(dbms_random.value(1,10))
       );
commit;
DELETE FROM USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'PROJMULTIPOINT2D'; 
COMMIT;
DECLARE
  v_shape mdsys.sdo_geometry;
BEGIN
  SELECT SDO_AGGR_MBR(geom) INTO v_shape FROM PROJMULTIPOINT2D;
  INSERT INTO USER_SDO_GEOM_METADATA(TABLE_NAME,COLUMN_NAME,DIMINFO,SRID)
    VALUES ('PROJMULTIPOINT2D',
            'GEOM',
            MDSYS.SDO_DIM_ARRAY(
                MDSYS.SDO_DIM_ELEMENT('X',V_SHAPE.SDO_ORDINATES(1),V_SHAPE.SDO_ORDINATES(3),0.05),
                MDSYS.SDO_DIM_ELEMENT('Y',V_SHAPE.SDO_ORDINATES(2),V_SHAPE.SDO_ORDINATES(4),0.05)),
            NULL);
END;
/
SHOW ERRORS
SELECT diminfo from USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'PROJMULTIPOINT2D'; 
DROP INDEX PROJMULTIPOINT2D_Geom;
CREATE INDEX PROJMULTIPOINT2D_Geom on PROJMULTIPOINT2D(geom) 
       indextype is mdsys.spatial_index 
       parameters('sdo_indx_dims=2, layer_gtype=multipoint');

-- *****************************************************************************

DROP TABLE Proj41014Poly2D;
CREATE TABLE Proj41014Poly2D ( PolyType Varchar2(40), geom mdsys.sdo_geometry );
INSERT INTO Proj41014Poly2D
VALUES ( 'MANYDIGITS',
MDSYS.SDO_GEOMETRY(2003, 41014, NULL,
MDSYS.SDO_ELEM_INFO_ARRAY(1, 1003, 1),
MDSYS.SDO_ORDINATE_ARRAY(
703004.4000000001, 1829970.0999999999,
703014.8000000000, 1829973.6000000001,
703018.3000000000, 1829983.8999999999,
703019.1000000001, 1830008.2000000000,
703013.9000000001, 1830033.2000000000,
703001.8000000000, 1830043.5999999999,
702994.9000000001, 1830037.4999999998,
702989.7000000001, 1830019.3999999999,
702990.5000000001, 1829991.7000000000,
702993.2000000001, 1829975.3000000000,
703004.4000000001, 1829970.0999999999)));
INSERT INTO PROJ41014POLY2D
VALUES ( 'ONEDIGIT',
MDSYS.SDO_GEOMETRY(2003, 41014, NULL, MDSYS.SDO_ELEM_INFO_ARRAY(1, 1003, 1),
MDSYS.SDO_ORDINATE_ARRAY(
703004.4, 1829970.1, 703014.8, 1829973.6, 703018.3, 1829983.9, 703019.1, 1830008.2, 
703013.9, 1830033.2, 703001.8, 1830043.6, 702994.9, 1830037.5, 702989.7, 1830019.4, 
702990.5, 1829991.7, 702993.2, 1829975.3, 703004.4, 1829970.1)));
INSERT INTO PROJ41014POLY2D
VALUES ( 'POLYGON',
         MDSYS.SDO_GEOMETRY(2003, 41014, NULL, MDSYS.SDO_ELEM_INFO_ARRAY(1, 1003, 1),
         MDSYS.SDO_ORDINATE_ARRAY(
         721336.1, 1835841.6, 721318.0, 1835849.6, 721307.8, 1835854.1, 
         721295.0, 1835856.4, 721286.0, 1835847.5, 721275.5, 1835828.2, 
         721246.3, 1835816.7, 721214.4, 1835810.2, 721201.3, 1835793.6, 
         721164.1, 1835759.7, 721093.2, 1835715.2, 721120.9, 1835681.6, 
         721144.2, 1835692.1, 721270.0, 1835764.9, 721312.8, 1835725.2, 
         721316.1, 1835720.6, 721323.3, 1835735.9, 721340.7, 1835748.0, 
         721381.9, 1835744.2, 721428.2, 1835732.8, 721448.9, 1835730.7, 
         721454.9, 1835737.5, 721457.8, 1835748.7, 721454.8, 1835761.6, 
         721443.2, 1835773.2, 721422.9, 1835783.2, 721404.2, 1835795.9, 
         721387.0, 1835813.8, 721354.4, 1835833.6, 721336.1, 1835841.6)));
COMMIT;
DELETE FROM USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'PROJ41014POLY2D'; 
COMMIT;
DECLARE
  v_shape mdsys.sdo_geometry;
BEGIN
  SELECT SDO_AGGR_MBR(geom) INTO v_shape FROM PROJ41014POLY2D;
  INSERT INTO USER_SDO_GEOM_METADATA(TABLE_NAME,COLUMN_NAME,DIMINFO,SRID)
    VALUES ('PROJ41014POLY2D',
            'GEOM',
            MDSYS.SDO_DIM_ARRAY(
                MDSYS.SDO_DIM_ELEMENT('X',V_SHAPE.SDO_ORDINATES(1),V_SHAPE.SDO_ORDINATES(3),0.05),
                MDSYS.SDO_DIM_ELEMENT('Y',V_SHAPE.SDO_ORDINATES(2),V_SHAPE.SDO_ORDINATES(4),0.05)),
            41014);
END;
/
SHOW ERRORS
SELECT diminfo from USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'PROJ41014POLY2D'; 
DROP INDEX PROJ41014POLY2D_Geom;
CREATE INDEX PROJ41014POLY2D_Geom on PROJ41014POLY2D(geom) 
       indextype is mdsys.spatial_index 
       parameters('sdo_indx_dims=2, layer_gtype=polygon');

-- *****************************************************************************

DROP   TABLE ProjPoint3D PURGE;
CREATE TABLE ProjPoint3D ( id integer, geom MDSYS.SDO_GEOMETRY );
COMMIT;
SET FEEDBACK OFF
    INSERT INTO ProjPoint3D
      SELECT rownum,
             mdsys.sdo_geometry(3001,NULL,
                   MDSYS.SDO_POINT_TYPE(
                         ROUND(dbms_random.value(358880  - ( 10000 / 2 ),  
                                                 358880  + ( 10000 / 2 )),2),
                         ROUND(dbms_random.value(5407473 - (  5000 / 2 ), 
                                                 5407473 + (  5000 / 2 )),2),
                         ROUND(dbms_random.value( -1000 - ( 10000 / 2 ), 
                                                   1000 + ( 10000 / 2 )),2)),
                   NULL,NULL)
       FROM DUAL
     CONNECT BY LEVEL <= 500; 
COMMIT;
SET FEEDBACK ON
SELECT COUNT(*) FROM ProjPoint3D;

SELECT 'Inserted '||count(*)||' records into ProjPoint3D' FROM ProjPoint3D;
SET HEADING ON
DELETE FROM USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'PROJPOINT3D'; 
COMMIT;
DECLARE
  v_shape mdsys.sdo_geometry;
BEGIN
  SELECT SDO_AGGR_MBR(geom) INTO v_shape FROM PROJPoint3D;
  INSERT INTO USER_SDO_GEOM_METADATA(TABLE_NAME,COLUMN_NAME,DIMINFO,SRID)
    VALUES ('PROJPOINT3D','GEOM',MDSYS.SDO_DIM_ARRAY(
    MDSYS.SDO_DIM_ELEMENT('X',V_SHAPE.SDO_ORDINATES(1),V_SHAPE.SDO_ORDINATES(2),0.005),
    MDSYS.SDO_DIM_ELEMENT('Y',V_SHAPE.SDO_ORDINATES(3),V_SHAPE.SDO_ORDINATES(4),0.005),
    MDSYS.SDO_DIM_ELEMENT('Z',V_SHAPE.SDO_ORDINATES(3),V_SHAPE.SDO_ORDINATES(4),0.005)),NULL);
END;
/
SHOW ERRORS
CREATE INDEX ProjPoint3D_Geom on ProjPoint3D(geom) 
       indextype is mdsys.spatial_index 
       parameters('sdo_indx_dims=2, layer_gtype=point');

-- ****************************************************************

DROP   TABLE PROJMULTIPOINT3D PURGE;
CREATE TABLE ProjMultiPoint3D ( geom MDSYS.SDO_GEOMETRY );
INSERT INTO  ProjMultiPoint3D 
VALUES ( MDSYS.SDO_GEOMETRY(3005,NULL,NULL,
               MDSYS.SDO_ELEM_INFO_ARRAY(1,1,4),
               MDSYS.SDO_ORDINATE_ARRAY(252000,5526500,1,253000,5526000,2,254000,5526000,3,254000,5527000,4)));
COMMIT;
DELETE FROM USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'PROJMULTIPOINT3D'; 
COMMIT;
DECLARE
  v_shape mdsys.sdo_geometry;
BEGIN
  SELECT SDO_AGGR_MBR(geom) INTO v_shape FROM PROJMULTIPOINT3D;
  INSERT INTO USER_SDO_GEOM_METADATA(TABLE_NAME,COLUMN_NAME,DIMINFO,SRID)
    VALUES ('PROJMULTIPOINT3D',
            'GEOM',
            MDSYS.SDO_DIM_ARRAY(
                MDSYS.SDO_DIM_ELEMENT('X',V_SHAPE.SDO_ORDINATES(1),V_SHAPE.SDO_ORDINATES(4),0.05),
                MDSYS.SDO_DIM_ELEMENT('Y',V_SHAPE.SDO_ORDINATES(2),V_SHAPE.SDO_ORDINATES(5),0.05),
                MDSYS.SDO_DIM_ELEMENT('Z',V_SHAPE.SDO_ORDINATES(3),V_SHAPE.SDO_ORDINATES(6),0.05)),
            NULL);
END;
/
SHOW ERRORS
SELECT diminfo from USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'PROJMULTIPOINT3D'; 
DROP INDEX PROJMULTIPOINT3D_Geom;
CREATE INDEX PROJMULTIPOINT3D_Geom on PROJMULTIPOINT3D(geom) 
       indextype is mdsys.spatial_index 
       parameters('sdo_indx_dims=2, layer_gtype=multipoint');

-- *****************************************************************************

DROP   TABLE ProjLine3D PURGE;
CREATE TABLE ProjLine3D ( LineType VarChar2(40), geom MDSYS.SDO_GEOMETRY );
INSERT INTO  ProjLine3D 
VALUES ( 'COMPOUND',
    MDSYS.SDO_GEOMETRY(3002,NULL,NULL,
      mdsys.sdo_elem_info_array(1,4,2,1,2,1,4,2,2),
      MDSYS.SDO_ORDINATE_ARRAY(252000,5526000,1,252700,5526700,2,252500,5526700,3,252500,5526500,4))
);
INSERT INTO PROJLINE3D 
VALUES('VERTEX',
MDSYS.SDO_GEOMETRY(3002, NULL, NULL, 
MDSYS.SDO_ELEM_INFO_ARRAY(1, 2, 1), 
MDSYS.SDO_ORDINATE_ARRAY(
380326.792, 5167089.286, 1,
380326.792, 5167889.286, 2,
380826.792, 5167889.286, 3,
380126.792, 5167489.286, 4)));
COMMIT;
DELETE FROM USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'PROJLINE3D'; 
COMMIT;
DECLARE
  v_shape mdsys.sdo_geometry;
BEGIN
  SELECT SDO_AGGR_MBR(geom) INTO v_shape FROM PROJLINE3D;
  INSERT INTO USER_SDO_GEOM_METADATA(TABLE_NAME,COLUMN_NAME,DIMINFO,SRID)
    VALUES ('PROJLINE3D',
            'GEOM',
            MDSYS.SDO_DIM_ARRAY(
                MDSYS.SDO_DIM_ELEMENT('X',V_SHAPE.SDO_ORDINATES(1),V_SHAPE.SDO_ORDINATES(4),0.05),
                MDSYS.SDO_DIM_ELEMENT('Y',V_SHAPE.SDO_ORDINATES(2),V_SHAPE.SDO_ORDINATES(5),0.05),
                MDSYS.SDO_DIM_ELEMENT('Z',V_SHAPE.SDO_ORDINATES(3),V_SHAPE.SDO_ORDINATES(6),0.05)),
            NULL);
END;
/
SHOW ERRORS
SELECT diminfo from USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'PROJLINE3D'; 
DROP INDEX PROJLINE3D_Geom;
CREATE INDEX PROJLINE3D_Geom on PROJLINE3D(geom) 
       indextype is mdsys.spatial_index 
       parameters('sdo_indx_dims=2, layer_gtype=line');

-- *****************************************************************************

DROP   TABLE ProjPoly3D PURGE;
CREATE TABLE ProjPoly3D ( PolyType VarChar2(40), geom MDSYS.SDO_GEOMETRY );
INSERT INTO  ProjPoly3D 
VALUES ( 'COMPOUND',
         MDSYS.SDO_GEOMETRY(3003,NULL,NULL,
               MDSYS.SDO_ELEM_INFO_ARRAY(1,1005,2,1,2,1,7,2,2),
               MDSYS.SDO_ORDINATE_ARRAY(253014,5527010,1,253010,5527001,2,253006,5527011,3,253010,5527011,4,253014,5527010,1)));
INSERT INTO PROJPOLY3D
VALUES( 'VERTEXNOHOLE',
MDSYS.SDO_GEOMETRY(3003, NULL, NULL, 
MDSYS.SDO_ELEM_INFO_ARRAY(1, 1003, 1),
MDSYS.SDO_ORDINATE_ARRAY(
476400, 237700, 1,
475879.950, 237700, 2,
475939.060, 237634.800, 3,
476002.840, 237573.450, 4,
476045.530, 237559.550, 5,
476087, 237545.060, 6,
476135.250, 237525.530, 7,
476155.500, 237517.380, 8,
476170.250, 237509, 9,
476182.690, 237494.470, 10,
476226.190, 237551.520, 11,
476342.910, 237515.520, 12,
476400, 237494.926, 13,
476400, 237700, 1)));
COMMIT;
DELETE FROM USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'PROJPOLY3D'; 
COMMIT;
DECLARE
  v_shape mdsys.sdo_geometry;
BEGIN
  SELECT SDO_AGGR_MBR(geom) INTO v_shape FROM PROJPOLY3D;
  INSERT INTO USER_SDO_GEOM_METADATA(TABLE_NAME,COLUMN_NAME,DIMINFO,SRID)
    VALUES ('PROJPOLY3D',
            'GEOM',
            MDSYS.SDO_DIM_ARRAY(
                MDSYS.SDO_DIM_ELEMENT('X',V_SHAPE.SDO_ORDINATES(1),V_SHAPE.SDO_ORDINATES(4),0.05),
                MDSYS.SDO_DIM_ELEMENT('Y',V_SHAPE.SDO_ORDINATES(2),V_SHAPE.SDO_ORDINATES(5),0.05),
                MDSYS.SDO_DIM_ELEMENT('Z',V_SHAPE.SDO_ORDINATES(3),V_SHAPE.SDO_ORDINATES(6),0.05)),
            NULL);
END;
/
SHOW ERRORS
select diminfo from USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'PROJPOLY3D'; 
DROP INDEX PROJPOLY3D_Geom;
CREATE INDEX PROJPOLY3D_Geom on PROJPOLY3D(geom) 
       indextype is mdsys.spatial_index 
       parameters('sdo_indx_dims=2, layer_gtype=polygon');

-- *******************************************************************************************************

DROP   TABLE GeodPoint2D PURGE;
CREATE TABLE GeodPoint2D ( id integer, geom mdsys.sdo_geometry );
SET FEEDBACK OFF
    INSERT INTO GeodPoint2D
      SELECT rownum,
             mdsys.sdo_geometry(2001,8311,
                   MDSYS.SDO_POINT_TYPE(
                         ROUND(dbms_random.value(112,147),2),
                         ROUND(dbms_random.value(-10,-44),2),
                         NULL),
                   NULL,NULL)
       FROM DUAL
     CONNECT BY LEVEL <= 500; 
COMMIT;
SET FEEDBACK ON
SET HEADING OFF
SELECT 'Inserted '||count(*)||' records into GeodPoint2D' FROM ProjPoint2D;
SET HEADING ON
DELETE FROM USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'GEODPOINT2D'; 
COMMIT;
DECLARE
  v_shape mdsys.sdo_geometry;
BEGIN
  SELECT SDO_AGGR_MBR(geom) INTO v_shape FROM GEODPOINT2D;
  INSERT INTO USER_SDO_GEOM_METADATA(TABLE_NAME,COLUMN_NAME,DIMINFO,SRID)
    VALUES ('GEODPOINT2D','GEOM',MDSYS.SDO_DIM_ARRAY(
    MDSYS.SDO_DIM_ELEMENT('Longitude',V_SHAPE.SDO_ORDINATES(1),V_SHAPE.SDO_ORDINATES(3),0.05),
    MDSYS.SDO_DIM_ELEMENT('Latitude' ,V_SHAPE.SDO_ORDINATES(2),V_SHAPE.SDO_ORDINATES(4),0.05)),8311);
END;
/
SHOW ERRORS
SELECT diminfo FROM USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'GEODPOINT2D'; 
DROP INDEX GeodPoint2D_Geom;
CREATE INDEX GeodPoint2D_Geom on GeodPoint2D(geom) 
       INDEXTYPE IS mdsys.spatial_index 
       PARAMETERS('sdo_indx_dims=2, layer_gtype=point');

-- *******************************************************************************************************

DROP   TABLE GeodPoint3D PURGE;
CREATE TABLE GeodPoint3D ( id integer, geom mdsys.sdo_geometry );
SET FEEDBACK OFF
    INSERT INTO GeodPoint3D
      SELECT rownum,
             mdsys.sdo_geometry(3001,8311,
                   MDSYS.SDO_POINT_TYPE(
                         ROUND(dbms_random.value(112,147),2),
                         ROUND(dbms_random.value(-10,-44),2),
                         ROUND(dbms_random.value(0,10000),2)),
                   NULL,NULL)
       FROM DUAL
     CONNECT BY LEVEL <= 500; 
COMMIT;
SET FEEDBACK ON
SET HEADING OFF
SELECT 'Inserted '||count(*)||' records into GeodPoint3D' FROM ProjPoint3D;
SET HEADING ON
DELETE FROM USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'GEODPOINT3D'; 
COMMIT;
DECLARE
  v_shape mdsys.sdo_geometry;
BEGIN
  SELECT SDO_AGGR_MBR(geom) INTO v_shape FROM GEODPOINT3D;
  INSERT INTO USER_SDO_GEOM_METADATA(TABLE_NAME,COLUMN_NAME,DIMINFO,SRID)
    VALUES ('GEODPOINT3D','GEOM',MDSYS.SDO_DIM_ARRAY(
    MDSYS.SDO_DIM_ELEMENT('Longitude',V_SHAPE.SDO_ORDINATES(1),V_SHAPE.SDO_ORDINATES(4),0.05),
    MDSYS.SDO_DIM_ELEMENT('Latitude' ,V_SHAPE.SDO_ORDINATES(2),V_SHAPE.SDO_ORDINATES(5),0.05),
    MDSYS.SDO_DIM_ELEMENT('Z'        ,V_SHAPE.SDO_ORDINATES(3),V_SHAPE.SDO_ORDINATES(6),0.5)),8311);
END;
/
SHOW ERRORS
SELECT diminfo FROM USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'GEODPOINT3D'; 
DROP INDEX GEODPOINT3D_Geom;
CREATE INDEX GEODPOINT3D_Geom on GEODPOINT3D(geom) 
       indextype is mdsys.spatial_index 
       parameters('sdo_indx_dims=2, layer_gtype=point');

-- *******************************************************************************************************

DROP   TABLE GeodPoly2D  PURGE;
CREATE TABLE GeodPoly2D ( PolyType VARCHAR2(40), geom mdsys.sdo_geometry );
INSERT INTO  GeodPoly2D 
VALUES ( 'SIMPLE', 
MDSYS.SDO_GEOMETRY(2003, 8265, NULL, 
MDSYS.SDO_ELEM_INFO_ARRAY(1, 1003, 1),
MDSYS.SDO_ORDINATE_ARRAY(
-79.230383, 35.836761, -79.230381, 35.836795, -79.230414, 35.83683, -79.230468, 35.836857, 
-79.230502, 35.836878, -79.23055, 35.836906, -79.23059, 35.836922,  -79.230617, 35.836945,
-79.230658, 35.836966, -79.230671, 35.837005, -79.230698, 35.837048, -79.230704, 35.837082, 
-79.230712, 35.83712, -79.230711, 35.837192, -79.230725, 35.83722, -79.230779, 35.837247, 
-79.230792, 35.837202, -79.230785, 35.837114, -79.23078, 35.837087, -79.230765, 35.837038,
-79.230718, 35.836972, -79.230671, 35.836917, -79.230637, 35.8369, -79.23061, 35.836873,
-79.230583, 35.83685, -79.230529, 35.836818, -79.230489, 35.83679, -79.230456, 35.836774, -79.230383, 35.836761)));
COMMIT;
DELETE FROM USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'GEODPOLY2D'; 
COMMIT;
DECLARE
  v_shape mdsys.sdo_geometry;
BEGIN
  SELECT SDO_AGGR_MBR(geom) INTO v_shape FROM GEODPOLY2D;
  INSERT INTO USER_SDO_GEOM_METADATA(TABLE_NAME,COLUMN_NAME,DIMINFO,SRID)
    VALUES ('GEODPOLY2D',
            'GEOM',
            MDSYS.SDO_DIM_ARRAY(
                MDSYS.SDO_DIM_ELEMENT('X',V_SHAPE.SDO_ORDINATES(1),V_SHAPE.SDO_ORDINATES(3),0.05),
                MDSYS.SDO_DIM_ELEMENT('Y',V_SHAPE.SDO_ORDINATES(2),V_SHAPE.SDO_ORDINATES(4),0.05)),
            8265);
END;
/
SHOW ERRORS
SELECT diminfo FROM USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'GEODPOLY2D'; 
DROP INDEX GEODPOLY2D_Geom;
CREATE INDEX GEODPOLY2D_Geom on GEODPOLY2D(geom) 
       indextype is mdsys.spatial_index 
       parameters('sdo_indx_dims=2, layer_gtype=polygon');

-- *****************************************************************************

Drop Table Oriented_Point;
Create Table oriented_point (id number, Geom Sdo_Geometry);

insert into oriented_point (id,geom) values(4   ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42781396.2001512,457837132.60015,0,0.866186951907965,0.499720085992537,0)));
insert into oriented_point (id,geom) values(5   ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42792668.4002372,457751297.79978,0,0.901190729167113,-0.433422737824456,0)));
insert into oriented_point (id,geom) values(6   ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42667160.399947,457538468.700236,0,0.428026479913496,0.903766193488594,0)));
insert into oriented_point (id,geom) values(7   ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42718894.599856,457647416.600053,0,0.42815897572778,0.903703431167404,0)));
insert into oriented_point (id,geom) values(8   ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42611295.9003171,457662210.400047,0,0.899203704554947,-0.437530224915559,0)));
insert into oriented_point (id,geom) values(9   ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42689117.6003236,457624436.599882,0,0.899131824703949,-0.437677920170241,0)));
insert into oriented_point (id,geom) values(10  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42578371.9002364,457584580.400213,0,-0.458147322446748,0.888876274255802,0)));
insert into oriented_point (id,geom) values(11  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42576686.8003421,457648016.299926,0,0.0476250064202492,0.998865285593343,0)));
insert into oriented_point (id,geom) values(12  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42689623.3000174,457533376.699752,0,0.432077614330499,0.901836423745717,0)));
insert into oriented_point (id,geom) values(13  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42738282.7998623,457636926.800073,0,0.432109446059973,0.901821172198648,0)));
insert into oriented_point (id,geom) values(14  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42714357.800184,457609597.099871,0,0.903147173724776,-0.429331087382395,0)));
insert into oriented_point (id,geom) values(15  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42755707.2997359,457590167.599978,0,0.903093173438935,-0.429444664756699,0)));
insert into oriented_point (id,geom) values(16  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42595136.4997528,457562590.499812,0,0.701050436240618,-0.713111692406484,0)));
insert into oriented_point (id,geom) values(17  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42649943.0998217,457529070.700074,0,0.814219165191775,-0.580557620770246,0)));
insert into oriented_point (id,geom) values(18  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42742222.8998825,457657044.699892,0,0.901367188146727,-0.433055645538148,0)));
insert into oriented_point (id,geom) values(19  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42785448.8999858,457635923.800147,0,0.901402330392483,-0.43298249244398,0)));
insert into oriented_point (id,geom) values(20  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42645016.1997681,457544860.899796,0,0.428887615928739,0.903357854287525,0)));
insert into oriented_point (id,geom) values(21  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42673869.2997332,457605848.799862,0,0.42893990781684,0.903333025789537,0)));
insert into oriented_point (id,geom) values(22  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42609108.5003045,457682493.599973,0,0.917592159391778,0.39752311759536,0)));
insert into oriented_point (id,geom) values(23  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42639149.8000096,457696094.599694,0,0.917601991989816,0.397500420498296,0)));
insert into oriented_point (id,geom) values(24  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42661326.9997281,457708634.700357,0,0.937151463724862,0.348922819601052,0)));
insert into oriented_point (id,geom) values(25  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42720677.6999832,457667302.499645,0,0.90133464237071,-0.43312338018452,0)));
insert into oriented_point (id,geom) values(26  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42666479.6998888,457693719.100208,0,0.901404451709579,-0.432978076163392,0)));
insert into oriented_point (id,geom) values(27  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42700916.6000436,457726451.999871,0,0.900107297124788,0.435668283976133,0)));
insert into oriented_point (id,geom) values(28  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42769907.1000598,457758797.200342,0,0.903178916071127,0.429264307349894,0)));
insert into oriented_point (id,geom) values(29  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42726105.699922,457765433.799644,0,0.910535802478594,0.413430226767059,0)));
insert into oriented_point (id,geom) values(30  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42760797.9003093,457781108.400054,0,0.910566197801438,0.41336327778533,0)));
insert into oriented_point (id,geom) values(31  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42787789.1998665,457798116.299641,0,0.581870294946965,0.813281599360475,0)));
insert into oriented_point (id,geom) values(32  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42777725.5998672,457830794.599908,0,-0.548389560622166,0.836222990476002,0)));
insert into oriented_point (id,geom) values(33  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42767949.2998075,457846917.400233,0,-0.548393001336794,0.83622073406776,0)));
insert into oriented_point (id,geom) values(34  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42547459.2001328,457710601.899904,0,0.999928297660517,-0.0119749546028632,0)));
insert into oriented_point (id,geom) values(35  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42597550.699705,457706237.099652,0,0.988795284780353,-0.149277877785494,0)));
insert into oriented_point (id,geom) values(36  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42755650.6999512,457872110.900243,0,-0.475369336892883,0.879786334027769,0)));
insert into oriented_point (id,geom) values(37  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42760851.200357,457541741.299869,0,0.430855663965527,0.902420853498424,0)));
insert into oriented_point (id,geom) values(38  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42793214.9997396,457611387.200273,0,0.41926234942816,0.907865123436284,0)));
insert into oriented_point (id,geom) values(39  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42791845.7000778,457810399.399922,0,-0.548391421751044,0.83622176995691,0)));
insert into oriented_point (id,geom) values(40  ,SDO_GEOMETRY(3001,NULL,NULL,SDO_ELEM_INFO_ARRAY(1,1,1,4,1,0),SDO_ORDINATE_ARRAY(42748912.4997167,458100888.800304,0,0.999998306834155,0.00184019803928363,0)));
commit;

DELETE FROM USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'ORIENTED_POINT'; 
COMMIT;
DECLARE
  v_shape mdsys.sdo_geometry;
BEGIN
  SELECT SDO_AGGR_MBR(geom) INTO v_shape FROM GEODPoint3D;
  INSERT INTO USER_SDO_GEOM_METADATA(TABLE_NAME,COLUMN_NAME,DIMINFO,SRID)
    VALUES ('ORIENTED_POINT',
            'GEOM',
            MDSYS.SDO_DIM_ARRAY(
                MDSYS.SDO_DIM_ELEMENT('X',V_SHAPE.SDO_ORDINATES(1),V_SHAPE.SDO_ORDINATES(4),0.05),
                MDSYS.SDO_DIM_ELEMENT('Y',V_SHAPE.SDO_ORDINATES(2),V_SHAPE.SDO_ORDINATES(5),0.05),
                MDSYS.SDO_DIM_ELEMENT('Z',V_SHAPE.SDO_ORDINATES(3),V_SHAPE.SDO_ORDINATES(6),0.5)),
            NULL);
END;
/
SHOW ERRORS
SELECT diminfo FROM USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'ORIENTED_POINT'; 
DROP INDEX ORIENTED_POINT_Geom;
CREATE INDEX ORIENTED_POINT_Geom on ORIENTED_POINT(geom) 
       indextype is mdsys.spatial_index 
       parameters('sdo_indx_dims=3, layer_gtype=point');

purge recyclebin;
EXIT;
>>>>>>> f451c665d66e01246b5122c52edb6148edbfed5d
